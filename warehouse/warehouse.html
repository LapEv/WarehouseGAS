<!DOCTYPE html>
<html>

<head>
  <base target="_top">
  <style type="text/css">
    *::-webkit-scrollbar {
      background-color: #1E515D;
      border-radius: 8px;
      width: 8px
    }

    *::-webkit-scrollbar-track {
      background-color: #326f7c;
      -webkit-box-shadow: inset 0 0 6px rgba(0, 0, 0, 0.3);
      -webkit-border-radius: 8px;
      border-radius: 8px;
      width: 8px
    }

    *::-webkit-scrollbar-thumb {
      border-radius: 8px;
      background-color: #1E515D;
      min-height: 14px;
      -webkit-border-radius: 8px;
      border-radius: 8px;
      -webkit-box-shadow: inset 0 0 6px rgba(31, 10, 10, 0.5);
      width: 8px
    }

    *::-webkit-scrollbar-thumb:hover,
    ::-webkit-scrollbar-track:hover {
      cursor: pointer
    }

    ::-moz-scrollbar-button,
    ::-webkit-scrollbar-button {
      display: none;
    }

    html {
      width: 100%;
    }

    body {
      margin: 0;
      background-color: #C1EEE1;
      width: 100%;
      display: flex;
      align-items: center;
      flex-direction: column;
    }

    .checkAccessPaper {
      display: none;
      position: absolute;
      background-color: #C1EEE1;
      z-index: 12;
      width: 100%;
      height: 100%;
    }

    .back {
      display: none;
      position: absolute;
      background-color: rgba(0, 0, 0, 0.4);
      width: 100%;
      height: 100%;
      border-radius: 4px;
      z-index: 13;
    }

    .loader {
      display: block;
      margin: 30% auto;
      border-top: 7px solid #34db80;
      border-radius: 50%;
      width: 60px;
      height: 60px;
      animation: spin 2s linear infinite;
    }

    .container {
      width: 90%;
      margin-top: 100px;
      display: flex;
      justify-content: center;
      align-items: center;
      box-shadow: 0px 0px 7px 4px rgba(0, 0, 0, 0.2);
      border-radius: 5px
    }

    .modalMessage {
      display: none;
      flex-direction: column;
      position: absolute;
      justify-content: space-around;
      align-items: center;
      width: 30%;
      height: auto;
      min-height: 180px;
      border-radius: 4px;
      background-color: #C1EEE1;
      -webkit-box-shadow: 0 0 17px 10px #666;
      box-shadow: 0 0 17px 10px #666;
      z-index: 99;
      padding: 30px;
    }

    .modalMessage_text {
      text-align: center;
      line-height: 1.5;
    }

    #buttonModalMessage {
      width: 150px;
      height: 30px;
    }

    .modalSVGOK,
    .modalSVGErr {
      width: 60px;
      height: 60px;
    }

    @keyframes spin {
      0% {
        transform: rotate(0deg);
      }

      100% {
        transform: rotate(360deg);
      }
    }

    .homepage {
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      color: #113d47;
      width: 100%;
      height: 80vh;
      background-color: #C1EEE1;
      z-index: 1;
      padding: 20px;
    }

    .navbar {
      width: 100%;
      height: 60px;
      display: flex;
      justify-content: center;
      align-items: center;
      position: fixed;
      top: 0;
      font-size: 24px;
      font-weight: bold;
      box-shadow: 0px 0px 7px 4px rgba(0, 0, 0, 0.2);
      background-color: #C1EEE1;
      z-index: 1;
    }

    button {
      color: #113d47;
      cursor: pointer;
      font-size: 16px;
      padding: 6px 12px;
      margin: 10px auto;
      border: 0;
      border-radius: 4px;
      width: 300px;
      height: 40px;
      background-color: #C1EEE1;
      font-weight: bold;
      box-shadow: 0px 0px 7px 4px rgba(0, 0, 0, 0.2);
      transition: background-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms, box-shadow 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms, border-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms, color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;
      outline: none;
    }

    button:focus {
      border: 1px solid #0d5c11;
    }

    .btnContainer {
      display: flex;
      flex-direction: row;
      height: 95%;
      width: 100%
    }

    .btnContainer1,
    .btnContainer2 {
      display: flex;
      flex-direction: column;
      justify-content: flex-start;
      align-items: center;
      height: 95%;
      width: 50%
    }

    button:hover {
      background-color: rgb(135, 166, 157);
      box-shadow: 0px 2px 4px -1px rgba(0, 0, 0, 0.2), 0px 4px 5px 0px rgba(0, 0, 0, 0.14), 0px 1px 10px 0px rgba(0, 0, 0, 0.12);
    }

    hr {
      color: #000000;
      width: 50%;
      margin: 20px auto;

    }

    .svg {
      fill: #08793b;
      color: #08793b
    }

    .newArrivalZIPContainer,
    .newArrivalPodmenaContainer,
    .newMovingZIPContainer,
    .newMovingPodmenaContainer,
    .newWriteOffZIPContainer,
    .newWriteOffPodmenaContainer,
    .PrintZIPContainer,
    .PrintPodmenaContainer,
    .PrintAllContainer,
    .dataZIPContainer,
    .dataPodmenaContainer,
    .dataWarehouseContainer {
      display: none;
      justify-content: flex-start;
      flex-direction: column;
      position: absolute;
      background-color: #C1EEE1;
      width: 500px;
      height: auto;
      box-shadow: 0px 0px 7px 4px rgba(0, 0, 0, 0.2);
      max-height: 650px;
      min-height: 300px;
      z-index: 15;
      border: 0;
      border-radius: 4px;
      font-size: 16px;
      font-weight: bold;
    }

    .inputsContainer {
      width: 100%;
      display: flex;
      align-items: center;
      justify-content: flex-start;
      flex-direction: column;
      overflow-y: overlay;
    }

    .titleBar {
      width: 100%;
      height: 50px;
      box-shadow: 0px 0px 7px 4px rgba(0, 0, 0, 0.2);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
      min-height: 40px;
    }

    .closeForm{
      position: absolute;
      right: 10px;
      top: 7px;
      cursor: pointer
    }

    .inputContainer,
    .inputContainerFile {
      display: inline-flex;
      -webkit-flex-direction: column;
      -ms-flex-direction: column;
      flex-direction: column;
      position: relative;
      min-width: 0;
      padding: 0;
      margin: 0;
      border: 0;
      vertical-align: top;
      margin-bottom: 8px;
      width: 90%;
    }

    .inputContainer.first {
      margin-top: 30px;
    }

    .inputLabel {
      top: -7px;
      margin-top: 0;
      font-weight: normal;
      color: #C1EEE1;
      font-size: 12px;
      font-family: Raleway;
      line-height: 1.4375em;
      padding: 0;
      position: relative;
      display: block;
      transform-origin: top left;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      max-width: calc(100% - 24px);
      position: absolute;
      left: 0;
      -webkit-transform: translate(14px, 16px) scale(1);
      -moz-transform: translate(14px, 16px) scale(1);
      -ms-transform: translate(14px, 16px) scale(1);
      transform: translate(14px, 16px) scale(1);
      -webkit-transition: color 200ms cubic-bezier(0.0, 0, 0.2, 1) 0ms, -webkit-transform 200ms cubic-bezier(0.0, 0, 0.2, 1) 0ms, top 200ms cubic-bezier(0.0, 0, 0.2, 1) 0ms;
      transition: color 200ms cubic-bezier(0.0, 0, 0.2, 1) 0ms, transform 200ms cubic-bezier(0.0, 0, 0.2, 1) 0ms, top 200ms cubic-bezier(0.0, 0, 0.2, 1) 0ms;
      z-index: 1;
      pointer-events: none;
    }

    .inputFile {
      width: 97%;
      padding: 10px;
      cursor: pointer;
      color: #ef5350;

    }

    .inputFile::after {
      margin-right: 10px;
    }

    .inputFile::file-selector-button {
      color: #113d47;
      cursor: pointer;
      font-size: 14px;
      padding: 6px 12px;
      border: 0;
      border-radius: 4px;
      width: 140px;
      height: 30px;
      background-color: #C1EEE1;
      font-weight: bold;
      box-shadow: 0px 0px 7px 4px rgba(0, 0, 0, 0.2);
      transition: background-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms, box-shadow 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms, border-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms, color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;
      outline: none;
    }

    .inputFile::file-selector-button:hover {
      background-color: rgb(135, 166, 157);
      box-shadow: 0px 2px 4px -1px rgba(0, 0, 0, 0.2), 0px 4px 5px 0px rgba(0, 0, 0, 0.14), 0px 1px 10px 0px rgba(0, 0, 0, 0.12);
    }

    .inputFileLabel {
      position: relative;
      display: flex;
      flex-direction: column;
      justify-content: space-around;
      align-items: center;
      height: 70px;
      padding: 20px;
      border-radius: 10px;
      border: 2px dashed #C1EEE1;
      color: #C1EEE1;
      cursor: pointer;
      background: #1E515D;
      transition: background .2s ease-in-out, border .2s ease-in-out;
    }

    .inputFileLabel:hover,
    .drag_active {
      background-color: rgb(135, 166, 157);
      border-color: #1E515D;
    }

    .inputOutlinedContainer {
      border-radius: 5px;
      font-weight: normal;
      background-color: #1E515D;
      color: #FFFFFF;
      font-size: 12px;
      font-family: Raleway;
      line-height: 1.4375em;
      box-sizing: border-box;
      cursor: text;
      display: -webkit-inline-box;
      display: -webkit-inline-flex;
      display: -ms-inline-flexbox;
      display: inline-flex;
      -webkit-align-items: center;
      -webkit-box-align: center;
      -ms-flex-align: center;
      align-items: center;
      height: 35px;
      position: relative;
      border-radius: 4px;
    }

    .inputOutlined {
      height: 35px;
      font-size: 14px;
      letter-spacing: inherit;
      color: currentColor;
      padding: 4px 0 5px;
      border: 0;
      box-sizing: content-box;
      background: none;
      margin: 0;
      -webkit-tap-highlight-color: transparent;
      display: block;
      min-width: 0;
      width: 100%;
      -webkit-animation-name: mui-auto-fill-cancel;
      animation-name: mui-auto-fill-cancel;
      -webkit-animation-duration: 10ms;
      animation-duration: 10ms;
      padding: 0 14px;
      outline: none
    }

    .inputOutlined.disabled {
      background-color: rgba(0, 0, 0, 0.3);
      color: #1E515D;
    }

    .textareaOutlined {
      min-width: 95%;
      min-height: 80px;
      background-color: #1E515D;
      color: #FFFFFF;
      border-radius: 5px;
      border: none;
      outline: none;
      padding: 10px 10px;
      font-size: 14px;
      resize: none;
    }

    .inputError,
    .inputsWarning {
      display: block;
      color: #ef5350;
      font-size: 12px;
      margin: 3px 12px;
      height: 20px;
      text-align: left;
    }


    .inputContainer:focus-within label,
    .inputLabelActive {
      color: #1E515D;
      top: -32px;
    }

    .inputContainer:focus-within input {
      border: none
    }

    .inputContainer:focus-within fieldset {
      border: none
    }

    .multiInputContainer {
      height: 100px;
      display: flex;
      align-items: flex-start;
      border-radius: 5px;
      background-color: #1E515D;
    }

    .btnSubmitContainer {
      display: flex;
      width: 90%;
      margin-bottom: 10px;
    }

    #btnSubmit,
    #btnCancel {
      width: 40%
    }

    .popover {
      display: none;
      position: absolute;
      inset: 0px auto auto 0px;
      margin: 0px;
      transform: translate(413px, 341px);
      z-index: 9999;
    }

    .popover_paper {
      background-color: #1E515D;
      border-radius: 4px;
      overflow: auto;
      box-shadow: 0px 20px 5px 0px rgba(0, 0, 0, 0.3);
    }

    .popover_listbox,
    .popoverNoElements {
      color: #FFFFFF;
      list-style: none;
      margin: 0;
      padding: 8px 10px;
      overflow: auto;
      position: relative;
      border-width: 1px;
      font-weight: normal;
      font-size: 14px;
      min-height: 0;
      max-height: 0;
      cursor: pointer;
    }

    .popoverNoElements {
      min-height: 20px;
      color: rgba(255, 255, 255, 0.6);

    }

    .popover li {
      height: 25px;
      display: flex;
      align-items: center
    }

    .popover li.popoverKeyActive,
    .popover li.popoverKeySelected {
      background-color: rgba(193, 238, 225, 0.08);
      font-weight: bold;
      color: #34db80
    }

    .popover li:hover {
      color: #C1EEE1;
      font-weight: bold;
    }

    .svgDropdownCross {
      width: 30px;
      height: 30px;
      margin-right: 10px;
      cursor: pointer
    }

    .svgFileClear {
      width: 35px;
      height: 35px;
      cursor: pointer;
      position: absolute;
      top: 50px;
      right: -3px;
    }

    #printContent {
      position: absolute;
      z-index: -1;
    }

    #dataZIP, 
    #dataPodmena,
    #dataWarehouse {
      width: 100%
    }

    .dataForm, .printStyleReport {
      display: flex;
      justify-content: space-around;
      align-items: flex-start;
    }

    .printStyleReport {
      width: 120vH;
      margin-top: 110px;
    }

    .dataForm td, .printStyleReport td{
      padding: 5px 10px;
      border: 1px solid #000;
      text-align: left;
      font-weight: normal;
      font-size: 13px;
    }

    .dataForm th,  .printStyleReport th {
      padding: 5px 10px;
      border: 1px solid #000;
      text-align: center;
      font-size: 14px;
    }

    .dataForm th:nth-child(2), .printStyleReport th:nth-child(2) {
      width: 85px
    }

    .dataForm td:nth-child(even), .printStyleReport  td:nth-child(even){
      text-align: center;
    }

    .dataForm table, .printStyleReport table {
      border-collapse: collapse;
      border-spacing: 0;
      width: 90%
    }

    @media screen and (max-width: 800px) {
      button {
        width: 150px;
        height: 32px;
        font-size: 11px;
      }

      .container {
        width: 360px;
      }

      .newArrivalZIPContainer,
      .newArrivalPodmenaContainer,
      .newMovingZIPContainer,
      .newMovingPodmenaContainer,
      .newWriteOffZIPContainer,
      .newWriteOffPodmenaContainer,
      .PrintZIPContainer,
      .PrintPodmenaContainer,
      .PrintAllContainer,
      .dataZIPContainer,
      .dataPodmenaContainer,
      .dataWarehouseContainer {
        width: 320px;
        max-height: 600px;
      }

      .titleBar {
        font-size: 16px;
      }

      .inputLabel {
        font-size: 10px;
        top: -10px
      }

      .inputContainer:focus-within label,
      .inputLabelActive {
        color: #1E515D;
        top: -28px;
      }

      .inputOutlinedContainer {
        height: 25px;
      }

      .multiInputContainer {
        height: 100px;
      }

      .inputOutlined {
        font-size: 12px;
      }

      .textareaOutlined {
        font-size: 12px;
        min-width: 93%
      }

      .inputContainer {
        margin-bottom: 0px;
      }

      .inputContainer.first {
        margin-top: 20px;
      }

      .popover_listbox,
      .popoverNoElements {
        font-size: 12px;
      }

      .inputError,
      .inputsWarning {
        font-size: 10px;
      }

      .inputFileLabel {
        font-size: 12px;
      }

      .inputFile {
        font-size: 12px;
      }

      .inputFile::file-selector-button {
        font-size: 11px;
        width: 110px;
        height: 25px;
        padding: 3px 6px;
      }
    }

    @media screen and (max-width: 400px) {
      button {
        width: 120px;
        height: 26px;
        font-size: 8px;
      }

      .container {
        width: 300px;
      }

      .newArrivalZIPContainer,
      .newArrivalPodmenaContainer,
      .newMovingZIPContainer,
      .newMovingPodmenaContainer,
      .newWriteOffZIPContainer,
      .newWriteOffPodmenaContainer,
      .PrintZIPContainer,
      .PrintPodmenaContainer,
      .PrintAllContainer,
      .dataZIPContainer,
      .dataPodmenaContainer,
      .dataWarehouseContainer {
        width: 280px;
        max-height: 570px;
      }

      .textareaOutlined {
        font-size: 12px;
        min-width: 92%
      }

      .titleBar {
        font-size: 14px;
      }

      .inputFileLabel {
        font-size: 12px;
        height: 50px
      }
    }

    @media print {
      .container, .checkAccessPaper, .back * {
        display:none;
      }

      .printContent {
        display:block;
      }

      table{
        border-collapse: collapse;
        border-spacing: 0;
      }
      th, td{
          padding: 5px 10px;
          border: 1px solid #000;
          text-align: center;
      }
    }
    @page { size: A4 landscape }
</style>
</head>

<body style="word-break:break-word;font-family:sans-serif;">
  <div class="checkAccessPaper"></div>
  <div class="back">
    <div class="loader"></div>
  </div>
  <div class="container">
    <div class="modalMessage"></div>
    <div class="homepage">
      <div class="navbar">Склад</div>
      <div class="btnContainer">
        <div class="btnContainer1">
          <button id="btnNewArrivalZIP" type="button" onclick="newArrivalZIP()">Новое поступление ЗИП</button>
          <button id="btnNewArrivalPodmena" type="button" onclick="newArrivalPodmena()">Новое поступление
            подмены</button>
          <hr size=1>
          <button id="btnNewMovingZIP" type="button" onclick="newMovingZIP()">Создать перемещение
            ЗИП</button>
          <button id="btnNewMovingPodmena" type="button" onclick="newMovingPodmena()">Создать перемещение
            подмены</button>
          <hr size=1>
          <button id="btnWriteOffZip" type="button" onclick="writeOffZIP()">Списать ЗИП</button>
          <button id="btnWriteOffPodmena" type="button" onclick="writeOffPodmena()">Списать подмену</button>
        </div>
        <div class="btnContainer2">
          <button id="btnCreateDocumentZip" type="button" onclick="createDocumentZIP()">Печать перемещение ЗИП</button>
          <button id="btnCreateDocumentPodmena" type="button" onclick="createDocumentPodmena()">Печать перемещение подмены</button>
          <hr size=1>
          <button id="btnCollation" type="button" onclick="createDocumentAll()">Сверка по складам</button>
          <hr size=1>
          <button id="btnZIPReport" type="button" onclick="reportZIP()">Данные по ЗИП</button>
          <button id="btnPodmenaReport" type="button" onclick="reportPodmena()">Данные по подмене</button>
          <button id="btnWarehouseReport" type="button" onclick="reportWarehouse()">Данные по складам</button>
        </div>
      </div>
    </div>
    <form class="newArrivalZIPContainer">
      <div class="titleBar">Ввод нового поступления ЗИП</div>
      <div class="closeForm" onclick="cancelContainer('.newArrivalZIPContainer')">&#x2716;</div>
      <div class="inputsContainer">
        <div class="inputContainer first">
          <label class="inputLabel" for="nArZ1">Выберите поставщика*</label>
          <div class="inputOutlinedContainer">
            <input id="nArZ1" name="nArZ1.textRuEng" required="true" type="text" class="inputOutlined dropdown" value=""
              autocomplete="off" oninput="changeInputDropDown(this, 'listClient')"
              onkeydown="changeInputKeyDownDropDown(event.key, this, 'listClient')"
              onclick="changeInputClickDropDown(this, 'listClient', event.key)"
              onchange="changeInputDropDownCross(this)">
          </div>
          <span class="inputError"></span>
        </div>
        <div class="inputContainer">
          <label class="inputLabel" for="nArZ2">Выберите классификатор*</label>
          <div class="inputOutlinedContainer">
            <input id="nArZ2" name="nArZ2.textRuEng" required="true" type="text" class="inputOutlined dropdown" value=""
              autocomplete="off" oninput="changeInputDropDown(this, 'listClassifier')"
              onkeydown="changeInputKeyDownDropDown(event.key, this, 'listClassifier')"
              onclick="changeInputClickDropDown(this, 'listClassifier', event.key)"
              onchange="changeInputDropDownCross(this)">
          </div>
          <span class="inputError"></span>
        </div>
        <div class="inputContainer">
          <label class="inputLabel" for="nArZ3">Выберите модель*</label>
          <div class="inputOutlinedContainer">
            <input id="nArZ3" name="nArZ3.textRuEng" required="true" type="text" class="inputOutlined dropdown" value=""
              autocomplete="off" oninput="changeInputDropDown(this, 'listModel')"
              onkeydown="changeInputKeyDownDropDown(event.key, this, 'listModel')"
              onclick="changeInputClickDropDown(this, 'listModel')" onchange="changeInputDropDownCross(this)">
          </div>
          <span class="inputError"></span>
        </div>
        <div class="inputContainer">
          <label class="inputLabel" for="nArZ4">Выберите ЗИП*</label>
          <div class="inputOutlinedContainer">
            <input id="nArZ4" name="nArZ4.textRuEng" required="true" type="text" class="inputOutlined dropdown" value=""
              autocomplete="off" oninput="changeInputDropDown(this, 'listZIP')"
              onkeydown="changeInputKeyDownDropDown(event.key, this, 'listZIP')"
              onclick="changeInputClickDropDown(this, 'listZIP')" onchange="changeInputDropDownCross(this)">
          </div>
          <span class="inputError"></span>
        </div>
        <div class="inputContainer">
          <label class="inputLabel" for="nArZ5">На какой склад*</label>
          <div class="inputOutlinedContainer">
            <input id="nArZ5" name="nArZ5.textRuEng" required="true" type="text" class="inputOutlined dropdown" value=""
              autocomplete="off" oninput="changeInputDropDown(this, 'listWarehouses')"
              onkeydown="changeInputKeyDownDropDown(event.key, this, 'listWarehouses')"
              onclick="changeInputClickDropDown(this, 'listWarehouses')" onchange="changeInputDropDownCross(this)">
          </div>
          <span class="inputError"></span>
        </div>
        <div class="inputContainer">
          <label class="inputLabel inputLabelActive" for="nArZ6">Укажите количество*</label>
          <div class="inputOutlinedContainer">
            <input id="nArZ6" name="nArZ6.number" required="true" type="number" class="inputOutlined" value="1"
              autocomplete="off" min="1">
          </div>
          <span class=" inputError"></span>
        </div>
        <div class="inputContainer">
          <label class="inputLabel" for="nArZ7">Введите серийнные номера</label>
          <div class="inputOutlinedContainer multiInputContainer">
            <textarea id="nArZ7" name="nArZ7.textNoValidRequired" type="text" class="inputOutlined textareaOutlined"
              value="" autocomplete="off"></textarea>
          </div>
          <span class="inputError"></span>
        </div>
        <div class="inputContainer">
          <label class="inputLabel" for="nArZ8">Введите комментарии</label>
          <div class="inputOutlinedContainer multiInputContainer">
            <textarea id="nArZ8" name="nArZ8.textNoValidRequired" type="text" class="inputOutlined textareaOutlined"
              value="" autocomplete="off"></textarea>
          </div>
          <span class="inputError"></span>
        </div>
        <div class="inputContainerFile">
          <label class="inputFileLabel" for="nArZ9">Загрузите или перетащите акт*
            <input id="nArZ9" name="nArZ9.textLightValidation" required="true" type="file" class="inputFile" value=""
              autocomplete="off" multiple accept="application/pdf, image/*">
          </label>
          <span class="inputError"></span>
        </div>
        <span class="inputsWarning"></span>
        <div class="btnSubmitContainer">
          <button id="btnSubmit" type="button"
            onclick="handleNewContainer('.newArrivalZIPContainer')">Сохранить</button>
          <button id="btnCancel" type="button" onclick="cancelContainer('.newArrivalZIPContainer')">Отмена</button>
        </div>
      </div>
    </form>
    <form class="newArrivalPodmenaContainer">
      <div class="titleBar">Ввод нового поступления подмены</div>
      <div class="closeForm" onclick="cancelContainer('.newArrivalPodmenaContainer')">&#x2716;</div>
      <div class="inputsContainer">
        <div class="inputContainer first">
          <label class="inputLabel" for="nArP1">Выберите поставщика*</label>
          <div class="inputOutlinedContainer">
            <input id="nArP1" name="nArP1.textRuEng" required="true" type="text" class="inputOutlined dropdown" value=""
              autocomplete="off" oninput="changeInputDropDown(this, 'listClient')"
              onkeydown="changeInputKeyDownDropDown(event.key, this, 'listClient')"
              onclick="changeInputClickDropDown(this, 'listClient', event.key)"
              onchange="changeInputDropDownCross(this)">
          </div>
          <span class="inputError"></span>
        </div>
        <div class="inputContainer">
          <label class="inputLabel" for="nArP2">Выберите классификатор*</label>
          <div class="inputOutlinedContainer">
            <input id="nArP2" name="nArP2.textRuEng" required="true" type="text" class="inputOutlined dropdown" value=""
              autocomplete="off" oninput="changeInputDropDown(this, 'listClassifier')"
              onkeydown="changeInputKeyDownDropDown(event.key, this, 'listClassifier')"
              onclick="changeInputClickDropDown(this, 'listClassifier', event.key)"
              onchange="changeInputDropDownCross(this)">
          </div>
          <span class="inputError"></span>
        </div>
        <div class="inputContainer">
          <label class="inputLabel" for="nArP3">Выберите подмену*</label>
          <div class="inputOutlinedContainer">
            <input id="nArP3" name="nArP3.textRuEng" required="true" type="text" class="inputOutlined dropdown" value=""
              autocomplete="off" oninput="changeInputDropDown(this, 'listPodmena')"
              onkeydown="changeInputKeyDownDropDown(event.key, this, 'listPodmena')"
              onclick="changeInputClickDropDown(this, 'listPodmena')" onchange="changeInputDropDownCross(this)">
          </div>
          <span class="inputError"></span>
        </div>
        <div class="inputContainer">
          <label class="inputLabel" for="nArP4">На какой склад*</label>
          <div class="inputOutlinedContainer">
            <input id="nArP4" name="nArP4.textRuEng" required="true" type="text" class="inputOutlined dropdown" value=""
              autocomplete="off" oninput="changeInputDropDown(this, 'listWarehouses')"
              onkeydown="changeInputKeyDownDropDown(event.key, this, 'listWarehouses')"
              onclick="changeInputClickDropDown(this, 'listWarehouses')" onchange="changeInputDropDownCross(this)">
          </div>
          <span class="inputError"></span>
        </div>
        <div class="inputContainer">
          <label class="inputLabel" for="nArP5">Введите серийнные номера*</label>
          <div class="inputOutlinedContainer multiInputContainer">
            <textarea id="nArP5" name="nArP5.textLightValidation" required="true" type="text"
              class="inputOutlined textareaOutlined" value="" autocomplete="off"></textarea>
          </div>
          <span class="inputError"></span>
        </div>
        <div class="inputContainer">
          <label class="inputLabel" for="nArP6">Введите комментарии</label>
          <div class="inputOutlinedContainer multiInputContainer">
            <textarea id="nArP6" name="nArP6.textNoValidRequired" type="text" class="inputOutlined textareaOutlined"
              value="" autocomplete="off"></textarea>
          </div>
          <span class="inputError"></span>
        </div>
        <div class="inputContainerFile">
          <label class="inputFileLabel" for="nArP7">Загрузите или перетащите акт*
            <input id="nArP7" name="nArP7.textLightValidation" required="true" type="file" class="inputFile" value=""
              autocomplete="off" multiple accept="application/pdf, image/*">
          </label>
          <span class="inputError"></span>
        </div>
        <span class="inputsWarning"></span>
        <div class="btnSubmitContainer">
          <button id="btnSubmit" type="button"
            onclick="handleNewContainer('.newArrivalPodmenaContainer')">Сохранить</button>
          <button id="btnCancel" type="button" onclick="cancelContainer('.newArrivalPodmenaContainer')">Отмена</button>
        </div>
      </div>
    </form>
    <form class="newMovingZIPContainer">
      <div class="titleBar">Ввод нового перемещения ЗИП</div>
      <div class="closeForm" onclick="cancelContainer('.newMovingZIPContainer')">&#x2716;</div>
      <div class="inputsContainer">
        <div class="inputContainer first">
          <label class="inputLabel" for="nMvZ1">Выберите склад откуда*</label>
          <div class="inputOutlinedContainer">
            <input id="nMvZ1" name="nMvZ1.textRuEng" required="true" type="text" class="inputOutlined dropdown" value=""
              autocomplete="off" oninput="changeInputDropDown(this, 'listWarehouses')"
              onkeydown="changeInputKeyDownDropDown(event.key, this, 'listWarehouses')"
              onclick="changeInputClickDropDown(this, 'listWarehouses', event.key)"
              onchange="changeInputDropDownCross(this)">
          </div>
          <span class="inputError"></span>
        </div>
        <div class="inputContainer">
          <label class="inputLabel" for="nMvZ2">Выберите ЗИП*</label>
          <div class="inputOutlinedContainer">
            <input id="nMvZ2" name="nMvZ2.textRuEng" required="true" type="text" class="inputOutlined dropdown" value=""
              autocomplete="off" oninput="changeInputDropDown(this, 'listZIP')"
              onkeydown="changeInputKeyDownDropDown(event.key, this, 'listZIP')"
              onclick="changeInputClickDropDown(this, 'listZIP')" onchange="changeInputDropDownCross(this)">
          </div>
          <span class="inputError"></span>
        </div>
        <div class="inputContainer">
          <label class="inputLabel inputLabelActive" for="nMvZ3">Укажите количество*</label>
          <div class="inputOutlinedContainer">
            <input id="nMvZ3" name="nMvZ3.number" required="true" type="number" class="inputOutlined" value="1"
              autocomplete="off" min="1">
          </div>
          <span class=" inputError"></span>
        </div>
        <div class="inputContainer">
          <label class="inputLabel" for="nMvZ4">Выберите серийнные номера</label>
          <div class="inputOutlinedContainer multiInputContainer">
            <textarea id="nMvZ4" name="nMvZ4.textNoValidRequired" type="text" class="inputOutlined dropdown textareaOutlined" value=""
              autocomplete="off" readonly onclick="changeInputClickDropDown(this, 'listSerial')" onchange="changeInputDropDownCross(this)"></textarea>
          </div>
          <span class="inputError"></span>
        </div>
        <div class="inputContainer">
          <label class="inputLabel" for="nMvZ5">Выберите склад куда*</label>
          <div class="inputOutlinedContainer">
            <input id="nMvZ5" name="nMvZ5.textRuEng" required="true" type="text" class="inputOutlined dropdown" value=""
              autocomplete="off" oninput="changeInputDropDown(this, 'listWarehouses')"
              onkeydown="changeInputKeyDownDropDown(event.key, this, 'listWarehouses')"
              onclick="changeInputClickDropDown(this, 'listWarehouses')" onchange="changeInputDropDownCross(this)">
          </div>
          <span class="inputError"></span>
        </div>
        <div class="inputContainer">
          <label class="inputLabel" for="nMvZ6">Введите комментарии</label>
          <div class="inputOutlinedContainer multiInputContainer">
            <textarea id="nMvZ6" name="nMvZ6.textNoValidRequired" type="text" class="inputOutlined textareaOutlined"
              value="" autocomplete="off"></textarea>
          </div>
          <span class="inputError"></span>
        </div>
        <span class="inputsWarning"></span>
        <div class="btnSubmitContainer">
          <button id="btnSubmit" type="button"
            onclick="handleNewContainer('.newMovingZIPContainer')">Сохранить</button>
          <button id="btnCancel" type="button" onclick="cancelContainer('.newMovingZIPContainer')">Отмена</button>
        </div>
      </div>
    </form>
    <form class="newMovingPodmenaContainer">
      <div class="titleBar">Ввод нового перемещения подмены</div>
      <div class="closeForm" onclick="cancelContainer('.newMovingPodmenaContainer')">&#x2716;</div>
      <div class="inputsContainer">
        <div class="inputContainer first">
          <label class="inputLabel" for="nMvP1">Выберите склад откуда*</label>
          <div class="inputOutlinedContainer">
            <input id="nMvP1" name="nMvP1.textRuEng" required="true" type="text" class="inputOutlined dropdown" value=""
              autocomplete="off" oninput="changeInputDropDown(this, 'listWarehouses')"
              onkeydown="changeInputKeyDownDropDown(event.key, this, 'listWarehouses')"
              onclick="changeInputClickDropDown(this, 'listWarehouses', event.key)"
              onchange="changeInputDropDownCross(this)">
          </div>
          <span class="inputError"></span>
        </div>
        <div class="inputContainer">
          <label class="inputLabel" for="nMvP2">Выберите подмену*</label>
          <div class="inputOutlinedContainer">
            <input id="nMvP2" name="nMvP2.textRuEng" required="true" type="text" class="inputOutlined dropdown" value=""
              autocomplete="off" oninput="changeInputDropDown(this, 'listPodmena')"
              onkeydown="changeInputKeyDownDropDown(event.key, this, 'listPodmena')"
              onclick="changeInputClickDropDown(this, 'listPodmena')" onchange="changeInputDropDownCross(this)">
          </div>
          <span class="inputError"></span>
        </div>
        <div class="inputContainer">
          <label class="inputLabel" for="nMvP3">Выберите серийнные номера</label>
          <div class="inputOutlinedContainer multiInputContainer">
            <textarea id="nMvP3" name="nMvP3.textLightValidation" type="text" class="inputOutlined dropdown textareaOutlined" value=""
              autocomplete="off" required onclick="changeInputClickDropDown(this, 'listSerial')" onchange="changeInputDropDownCross(this)"></textarea>
          </div>
          <span class="inputError"></span>
        </div>
        <div class="inputContainer">
          <label class="inputLabel" for="nMvP4">Выберите склад куда*</label>
          <div class="inputOutlinedContainer">
            <input id="nMvP4" name="nMvP4.textRuEng" required="true" type="text" class="inputOutlined dropdown" value=""
              autocomplete="off" oninput="changeInputDropDown(this, 'listWarehouses')"
              onkeydown="changeInputKeyDownDropDown(event.key, this, 'listWarehouses')"
              onclick="changeInputClickDropDown(this, 'listWarehouses')" onchange="changeInputDropDownCross(this)">
          </div>
          <span class="inputError"></span>
        </div>
        <div class="inputContainer">
          <label class="inputLabel" for="nMvP5">Введите комментарии</label>
          <div class="inputOutlinedContainer multiInputContainer">
            <textarea id="nMvP6" name="nMvP6.textNoValidRequired" type="text" class="inputOutlined textareaOutlined"
              value="" autocomplete="off"></textarea>
          </div>
          <span class="inputError"></span>
        </div>
        <span class="inputsWarning"></span>
        <div class="btnSubmitContainer">
          <button id="btnSubmit" type="button"
            onclick="handleNewContainer('.newMovingPodmenaContainer')">Сохранить</button>
          <button id="btnCancel" type="button" onclick="cancelContainer('.newMovingPodmenaContainer')">Отмена</button>
        </div>
      </div>
    </form>
    <form class="newWriteOffZIPContainer">
      <div class="titleBar">Списание ЗИП</div>
      <div class="closeForm" onclick="cancelContainer('.newWriteOffZIPContainer')">&#x2716;</div>
      <div class="inputsContainer">
        <div class="inputContainer first">
          <label class="inputLabel" for="nWoZ1">Выберите склад откуда*</label>
          <div class="inputOutlinedContainer">
            <input id="nWoZ1" name="nWoZ1.textRuEng" required="true" type="text" class="inputOutlined dropdown" value=""
              autocomplete="off" oninput="changeInputDropDown(this, 'listWarehouses')"
              onkeydown="changeInputKeyDownDropDown(event.key, this, 'listWarehouses')"
              onclick="changeInputClickDropDown(this, 'listWarehouses', event.key)"
              onchange="changeInputDropDownCross(this)">
          </div>
          <span class="inputError"></span>
        </div>
        <div class="inputContainer">
          <label class="inputLabel" for="nWoZ2">Выберите ЗИП*</label>
          <div class="inputOutlinedContainer">
            <input id="nWoZ2" name="nWoZ2.textRuEng" required="true" type="text" class="inputOutlined dropdown" value=""
              autocomplete="off" oninput="changeInputDropDown(this, 'listZIP')"
              onkeydown="changeInputKeyDownDropDown(event.key, this, 'listZIP')"
              onclick="changeInputClickDropDown(this, 'listZIP')" onchange="changeInputDropDownCross(this)">
          </div>
          <span class="inputError"></span>
        </div>
        <div class="inputContainer">
          <label class="inputLabel inputLabelActive" for="nWoZ3">Укажите количество*</label>
          <div class="inputOutlinedContainer">
            <input id="nWoZ3" name="nWoZ3.number" required="true" type="number" class="inputOutlined" value="1"
              autocomplete="off" min="1">
          </div>
          <span class=" inputError"></span>
        </div>
        <div class="inputContainer">
          <label class="inputLabel" for="nWoZ4">Выберите серийнные номера*</label>
          <div class="inputOutlinedContainer multiInputContainer">
            <textarea id="nWoZ4" name="nWoZ4.textNoValidRequired" type="text" class="inputOutlined dropdown textareaOutlined" value=""
              autocomplete="off" readonly onclick="changeInputClickDropDown(this, 'listSerial')" onchange="changeInputDropDownCross(this)"></textarea>
          </div>
          <span class="inputError"></span>
        </div>
        <div class="inputContainer">
          <label class="inputLabel" for="nWoZ5">Выберите клиента*</label>
          <div class="inputOutlinedContainer">
            <input id="nWoZ5" name="nWoZ5.textRuEng" required="true" type="text" class="inputOutlined dropdown" value=""
              autocomplete="off" oninput="changeInputDropDown(this, 'listClient')"
              onkeydown="changeInputKeyDownDropDown(event.key, this, 'listClient')"
              onclick="changeInputClickDropDown(this, 'listClient')" onchange="changeInputDropDownCross(this)">
          </div>
          <span class="inputError"></span>
        </div>
        <div class="inputContainer">
          <label class="inputLabel" for="nWoZ6">Выберите объект клиента*</label>
          <div class="inputOutlinedContainer">
            <input id="nWoZ6" name="nWoZ6.textRuEng" required="true" type="text" class="inputOutlined dropdown" value=""
              autocomplete="off" oninput="changeInputDropDown(this, 'listObject')"
              onkeydown="changeInputKeyDownDropDown(event.key, this, 'listObject')"
              onclick="changeInputClickDropDown(this, 'listObject')" onchange="changeInputDropDownCross(this)">
          </div>
          <span class="inputError"></span>
        </div>
        <div class="inputContainer">
          <label class="inputLabel" for="nWoZ7">Введите номер заявки*</label>
          <div class="inputOutlinedContainer">
            <input id="nWoZ7" name="nWoZ7.textNoValidRequired" type="text" class="inputOutlined" value=""
              autocomplete="off">
          </div>
          <span class="inputError"></span>
        </div>
        <div class="inputContainer">
          <label class="inputLabel" for="nWoZ8">Введите комментарии</label>
          <div class="inputOutlinedContainer multiInputContainer">
            <textarea id="nWoZ8" name="nWoZ8.textNoValidRequired" type="text" class="inputOutlined textareaOutlined"
              value="" autocomplete="off"></textarea>
          </div>
          <span class="inputError"></span>
        </div>
        <div class="inputContainerFile">
          <label class="inputFileLabel" for="nWoZ9">Загрузите или перетащите акт*
            <input id="nWoZ9" name="nWoZ9.textLightValidation" required="true" type="file" class="inputFile" value=""
              autocomplete="off" multiple accept="application/pdf, image/*">
          </label>
          <span class="inputError"></span>
        </div>
        <span class="inputsWarning"></span>
        <div class="btnSubmitContainer">
          <button id="btnSubmit" type="button"
            onclick="handleNewContainer('.newWriteOffZIPContainer')">Сохранить</button>
          <button id="btnCancel" type="button" onclick="cancelContainer('.newWriteOffZIPContainer')">Отмена</button>
        </div>
      </div>
    </form>
    <form class="newWriteOffPodmenaContainer">
      <div class="titleBar">Списание подмены</div>
      <div class="closeForm" onclick="cancelContainer('.newWriteOffPodmenaContainer')">&#x2716;</div>
      <div class="inputsContainer">
        <div class="inputContainer first">
          <label class="inputLabel" for="nWoP1">Выберите склад откуда*</label>
          <div class="inputOutlinedContainer">
            <input id="nWoP1" name="nWoP1.textRuEng" required="true" type="text" class="inputOutlined dropdown" value=""
              autocomplete="off" oninput="changeInputDropDown(this, 'listWarehouses')"
              onkeydown="changeInputKeyDownDropDown(event.key, this, 'listWarehouses')"
              onclick="changeInputClickDropDown(this, 'listWarehouses', event.key)"
              onchange="changeInputDropDownCross(this)">
          </div>
          <span class="inputError"></span>
        </div>
        <div class="inputContainer">
          <label class="inputLabel" for="nWoP2">Выберите подмену*</label>
          <div class="inputOutlinedContainer">
            <input id="nWoP2" name="nWoP2.textRuEng" required="true" type="text" class="inputOutlined dropdown" value=""
              autocomplete="off" oninput="changeInputDropDown(this, 'listPodmena')"
              onkeydown="changeInputKeyDownDropDown(event.key, this, 'listPodmena')"
              onclick="changeInputClickDropDown(this, 'listPodmena')" onchange="changeInputDropDownCross(this)">
          </div>
          <span class="inputError"></span>
        </div>
        <div class="inputContainer">
          <label class="inputLabel" for="nWoP3">Выберите серийнные номера*</label>
          <div class="inputOutlinedContainer multiInputContainer">
            <textarea id="nWoP3" name="nWoP3.textNoValidRequired" type="text" class="inputOutlined dropdown textareaOutlined" value=""
              autocomplete="off" readonly required onclick="changeInputClickDropDown(this, 'listSerial')" onchange="changeInputDropDownCross(this)"></textarea>
          </div>
          <span class="inputError"></span>
        </div>
        <div class="inputContainer">
          <label class="inputLabel" for="nWoP4">Выберите клиента*</label>
          <div class="inputOutlinedContainer">
            <input id="nWoP4" name="nWoP4.textRuEng" required="true" type="text" class="inputOutlined dropdown" value=""
              autocomplete="off" oninput="changeInputDropDown(this, 'listClient')"
              onkeydown="changeInputKeyDownDropDown(event.key, this, 'listClient')"
              onclick="changeInputClickDropDown(this, 'listClient')" onchange="changeInputDropDownCross(this)">
          </div>
          <span class="inputError"></span>
        </div>
        <div class="inputContainer">
          <label class="inputLabel" for="nWoP5">Выберите объект клиента*</label>
          <div class="inputOutlinedContainer">
            <input id="nWoP5" name="nWoP5.textRuEng" required="true" type="text" class="inputOutlined dropdown" value=""
              autocomplete="off" oninput="changeInputDropDown(this, 'listObject')"
              onkeydown="changeInputKeyDownDropDown(event.key, this, 'listObject')"
              onclick="changeInputClickDropDown(this, 'listObject')" onchange="changeInputDropDownCross(this)">
          </div>
          <span class="inputError"></span>
        </div>
        <div class="inputContainer">
          <label class="inputLabel" for="nWoP6">Введите номер заявки*</label>
          <div class="inputOutlinedContainer">
            <input id="nWoP6" name="nWoP6.textNoValidRequired" type="text" class="inputOutlined" value=""
              autocomplete="off">
          </div>
          <span class="inputError"></span>
        </div>
        <div class="inputContainer">
          <label class="inputLabel" for="nWoP7">Введите комментарии</label>
          <div class="inputOutlinedContainer multiInputContainer">
            <textarea id="nWoP7" name="nWoP7.textNoValidRequired" type="text" class="inputOutlined textareaOutlined"
              value="" autocomplete="off"></textarea>
          </div>
          <span class="inputError"></span>
        </div>
        <div class="inputContainerFile">
          <label class="inputFileLabel" for="nWoP8">Загрузите или перетащите акт*
            <input id="nWoP8" name="nWoP8.textLightValidation" required="true" type="file" class="inputFile" value=""
              autocomplete="off" multiple accept="application/pdf, image/*">
          </label>
          <span class="inputError"></span>
        </div>
        <span class="inputsWarning"></span>
        <div class="btnSubmitContainer">
          <button id="btnSubmit" type="button"
            onclick="handleNewContainer('.newWriteOffPodmenaContainer')">Сохранить</button>
          <button id="btnCancel" type="button" onclick="cancelContainer('.newWriteOffPodmenaContainer')">Отмена</button>
        </div>
      </div>
    </form>
    <form class="PrintZIPContainer">
      <div class="titleBar">Печать перемещения ЗИП</div>
      <div class="closeForm" onclick="cancelContainer('.PrintZIPContainer')">&#x2716;</div>
      <div class="inputsContainer">
        <div class="inputContainer first">
          <label class="inputLabel" for="nPrZ1">Выберите склад*</label>
          <div class="inputOutlinedContainer">
            <input id="nPrZ1" name="nPrZ1.textRuEng" required="true" type="text" class="inputOutlined dropdown" value=""
              autocomplete="off" oninput="changeInputDropDown(this, 'listWarehouses')"
              onkeydown="changeInputKeyDownDropDown(event.key, this, 'listWarehouses')"
              onclick="changeInputClickDropDown(this, 'listWarehouses', event.key)"
              onchange="changeInputDropDownCross(this)">
          </div>
          <span class="inputError"></span>
        </div>
        <span class="inputsWarning"></span>
        <div class="btnSubmitContainer">
          <button id="btnSubmit" type="button"
            onclick="handleNewContainer('.PrintZIPContainer')">Распечатать</button>
          <button id="btnCancel" type="button" onclick="cancelContainer('.PrintZIPContainer')">Выйти</button>
        </div>
      </div>
    </form>
    <form class="PrintPodmenaContainer">
      <div class="titleBar">Печать перемещения ЗИП</div>
      <div class="closeForm" onclick="cancelContainer('.PrintPodmenaContainer')">&#x2716;</div>
      <div class="inputsContainer">
        <div class="inputContainer first">
          <label class="inputLabel" for="nPrP1">Выберите склад*</label>
          <div class="inputOutlinedContainer">
            <input id="nPrP1" name="nPrP1.textRuEng" required="true" type="text" class="inputOutlined dropdown" value=""
              autocomplete="off" oninput="changeInputDropDown(this, 'listWarehouses')"
              onkeydown="changeInputKeyDownDropDown(event.key, this, 'listWarehouses')"
              onclick="changeInputClickDropDown(this, 'listWarehouses', event.key)"
              onchange="changeInputDropDownCross(this)">
          </div>
          <span class="inputError"></span>
        </div>
        <span class="inputsWarning"></span>
        <div class="btnSubmitContainer">
          <button id="btnSubmit" type="button"
          onclick="handleNewContainer('.PrintPodmenaContainer')">Распечатать</button>
          <button id="btnCancel" type="button" onclick="cancelContainer('.PrintPodmenaContainer')">Выйти</button>
        </div>
      </div>
    </form>
    <form class="PrintAllContainer">
      <div class="titleBar">Печать склада</div>
      <div class="closeForm" onclick="cancelContainer('.PrintAllContainer')">&#x2716;</div>
      <div class="inputsContainer">
        <div class="inputContainer first">
          <label class="inputLabel" for="nPrA1">Выберите склад*</label>
          <div class="inputOutlinedContainer">
            <input id="nPrA1" name="nPrA1.textRuEng" required="true" type="text" class="inputOutlined dropdown" value=""
              autocomplete="off" oninput="changeInputDropDown(this, 'listWarehouses')"
              onkeydown="changeInputKeyDownDropDown(event.key, this, 'listWarehouses')"
              onclick="changeInputClickDropDown(this, 'listWarehouses', event.key)"
              onchange="changeInputDropDownCross(this)">
          </div>
          <span class="inputError"></span>
        </div>
        <span class="inputsWarning"></span>
        <div class="btnSubmitContainer">
          <button id="btnSubmit" type="button"
          onclick="handleNewContainer('.PrintAllContainer')">Распечатать</button>
          <button id="btnCancel" type="button" onclick="cancelContainer('.PrintAllContainer')">Выйти</button>
        </div>
      </div>
    </form>
    <form class="dataZIPContainer">
      <div class="titleBar">Данные по ЗИП</div>
      <div class="closeForm" onclick="cancelContainer('.dataZIPContainer')">&#x2716;</div>
      <div class="inputsContainer">
        <div class="inputContainer first">
          <label class="inputLabel" for="nDzC1">Выберите ЗИП*</label>
          <div class="inputOutlinedContainer">
            <input id="nDzC1" name="nDzC1.textRuEng" required="true" type="text" class="inputOutlined dropdown" value=""
              autocomplete="off" oninput="changeInputDropDown(this, 'listZip')"
              onkeydown="changeInputKeyDownDropDown(event.key, this, 'listZip')"
              onclick="changeInputClickDropDown(this, 'listZip', event.key)"
              onchange="changeInputDropDownCross(this)">
          </div>
          <span class="inputError"></span>
        </div>
        <div id="dataZIP"></div>
        <span class="inputsWarning"></span>
        <div class="btnSubmitContainer">
          <button id="btnSubmit" class="btnReport btnZIPReport" type="button" style="display: none;"
          onclick="printReport(this)">Распечатать</button>
          <button id="btnCancel" type="button" onclick="cancelContainer('.dataZIPContainer')">Выйти</button>
        </div>
      </div>
    </form>
    <form class="dataPodmenaContainer">
      <div class="titleBar">Данные по подмене</div>
      <div class="closeForm" onclick="cancelContainer('.dataPodmenaContainer')">&#x2716;</div>
      <div class="inputsContainer">
        <div class="inputContainer first">
          <label class="inputLabel" for="nDpC1">Выберите подмену*</label>
          <div class="inputOutlinedContainer">
            <input id="nDpC1" name="nDpC1.textRuEng" required="true" type="text" class="inputOutlined dropdown" value=""
              autocomplete="off" oninput="changeInputDropDown(this, 'listPodmena')"
              onkeydown="changeInputKeyDownDropDown(event.key, this, 'listPodmena')"
              onclick="changeInputClickDropDown(this, 'listPodmena', event.key)"
              onchange="changeInputDropDownCross(this)">
          </div>
          <span class="inputError"></span>
        </div>
        <div id="dataPodmena"></div>
        <span class="inputsWarning"></span>
        <div class="btnSubmitContainer">
          <button id="btnSubmit" class="btnReport btnPodmenaReport" type="button" style="display: none;"
          onclick="printReport(this)">Распечатать</button>
          <button id="btnCancel" type="button" onclick="cancelContainer('.dataPodmenaContainer')">Выйти</button>
        </div>
      </div>
    </form>
    <form class="dataWarehouseContainer">
      <div class="titleBar">Данные по складам</div>
      <div class="closeForm" onclick="cancelContainer('.dataWarehouseContainer')">&#x2716;</div>
      <div class="inputsContainer">
        <div class="inputContainer first">
          <label class="inputLabel" for="nDwC1">Выберите склад*</label>
          <div class="inputOutlinedContainer">
            <input id="nDwC1" name="nDwC1.textRuEng" required="true" type="text" class="inputOutlined dropdown" value=""
              autocomplete="off" oninput="changeInputDropDown(this, 'listWarehouses')"
              onkeydown="changeInputKeyDownDropDown(event.key, this, 'listWarehouses')"
              onclick="changeInputClickDropDown(this, 'listWarehouses', event.key)"
              onchange="changeInputDropDownCross(this)">
          </div>
          <span class="inputError"></span>
        </div>
        <div id="dataWarehouse"></div>
        <span class="inputsWarning"></span>
        <div class="btnSubmitContainer">
          <button id="btnSubmit" class="btnReport btnWarehouseReport" type="button" style="display: none;"
          onclick="printReport(this)">Распечатать</button>
          <button id="btnCancel" type="button" onclick="cancelContainer('.dataWarehouseContainer')">Выйти</button>
        </div>
      </div>
    </form>
  </div>
  <div id="printContent"></div>
</body>
<script>
  window.onload = function () {
    document.querySelector('.checkAccessPaper').style.display = "block";
    document.querySelector('.back').style.display = "block";
    onSuccess({
      result: 'success',
      func: 'checkAccess',
      data: ['Лапкин Е.В.','evglapkin@gmail.com', 'Admin'],
      type: 'listClassifier'
    })
    // google.script.run
    //   .withSuccessHandler(onSuccess)
    //   .checkAccess('checkAccess')
  }

  const list = {
    listClassifier: [],
    listModel: [],
    listClient: [],
    listObject: [],
    listZIP: [],
    listSortZIP: [],
    listPodmena: [],
    listSortPodmena: [],
    listSerial: [],
    listWarehouses: [],
    prepareListModel: [],
    prepareListZIP: [],
    prepareListPodmena: [],
    prepareListObject: [],
    reportData: [],
    reportHTML: '',
    count: 0,
    fullLoad: 0,
    actNumber: 13,
    user: ''
  }

  function zeroingList(){
    list.listClassifier = [],
    list.listModel = [],
    list.listClient = [],
    list.listObject = [],
    list.listZIP = [],
    list.listSortZIP = [],
    list.listPodmena = [],
    list.listSerial = [],
    list.listWarehouses = [],
    list.prepareListModel = [],
    list.prepareListZIP = [],
    list.prepareListPodmena = [],
    list.prepareListObject = [],
    list.reportData = [],
    list.count = 0,
    list.fullLoad = 0
  }

  function onSuccess({
    result,
    func,
    data,
    type,
    option
  }) {
    if (func === 'checkAccess') {
      if (data.includes('Admin') || data.includes('Warehouse')) {
        list.user = data[0]
        document.querySelector('.checkAccessPaper').style.display = "none";
        document.querySelector('.back').style.display = "none";
        return
      }
      const modal = document.querySelector('.modalMessage');
      modal.innerHTML = svgErr +
        `<div class='modalMessage_text'><b>Отказано в доступе!</b></div>`;
      modal.style.display = "flex";
      setTimeout(() => {
        window.history.back()
      }, 3000)
    }
    if (func === 'newArrivalZIP') {
      const message1 = "ЗИП ";
      const message2 = " для классификатора ";
      const message3 = " и модели ";
      const message4 = " на склад ";
      const message5 = " в количестве ";
      const modal = document.querySelector('.modalMessage');
      modal.innerHTML = svgOk +
        `<div class='modalMessage_text'>${message1}<b>${data[3]}</b>${message2}<b>${data[1]}</b>${message3}<b>${data[2]}</b>${message4}<b>${data[4]}</b>${message5}<b>${data[5]}</b> записан в базу!</div><button id='buttonModalMessage' onClick='closeModalMessage(".newArrivalZIPContainer")'>OK</button>`;
      modal.style.display = "flex";
      document.getElementById('buttonModalMessage').focus();
    }
    if (func === 'newArrivalPodmena') {
      const message1 = "Подмена ";
      const message2 = " для классификатора ";
      const message3 = " на склад ";
      const modal = document.querySelector('.modalMessage');
      modal.innerHTML = svgOk +
        `<div class='modalMessage_text'>${message1}<b>${data[2]}</b>${message2}<b>${data[1]}</b>${message3}<b>${data[3]}</b> записан в базу!</div><button id='buttonModalMessage' onClick='closeModalMessage(".newArrivalPodmenaContainer")'>OK</button>`;
      modal.style.display = "flex";
      document.getElementById('buttonModalMessage').focus();
    }
    if (func === 'newMovingZIP') {
      const message1 = "Перемещение ЗИП ";
      const message2 = " со склада ";
      const message3 = " на склад ";
      const modal = document.querySelector('.modalMessage');
      modal.innerHTML = svgOk +
        `<div class='modalMessage_text'>${message1}<b>${data[1]}</b>${message2}<b>${data[0]}</b>${message3}<b>${data[4]}</b> записано в базу!</div><button id='buttonModalMessage' onClick='closeModalMessage(".newMovingZIPContainer")'>OK</button>`;
      modal.style.display = "flex";
      document.getElementById('buttonModalMessage').focus();
    }
    if (func === 'newMovingPodmena') {
      const message1 = "Перемещение подмены ";
      const message2 = " со склада ";
      const message3 = " на склад ";
      const modal = document.querySelector('.modalMessage');
      modal.innerHTML = svgOk +
        `<div class='modalMessage_text'>${message1}<b>${data[1]}</b>${message2}<b>${data[0]}</b>${message3}<b>${data[3]}</b> записан в базу!</div><button id='buttonModalMessage' onClick='closeModalMessage(".newMovingPodmenaContainer")'>OK</button>`;
      modal.style.display = "flex";
      document.getElementById('buttonModalMessage').focus();
    }
    if (func === 'newWriteOffZIP') {
      const message1 = "Списание ЗИП ";
      const message2 = " со склада ";
      const message3 = " клиенту ";
      const message4 = " объект ";
      const message5 = " по заявке ";
      const modal = document.querySelector('.modalMessage');
      modal.innerHTML = svgOk +
        `<div class='modalMessage_text'>${message1}<b>${data[1]}</b>${message2}<b>${data[0]}</b>${message3}<b>${data[4]}</b>${message4}<b>${data[5]}</b>${message5}<b>${data[6]}</b> записано в базу!</div><button id='buttonModalMessage' onClick='closeModalMessage(".newWriteOffZIPContainer")'>OK</button>`;
      modal.style.display = "flex";
      document.getElementById('buttonModalMessage').focus();
    }
    if (func === 'newWriteOffPodmena') {
      const message1 = "Списание подмены ";
      const message2 = " со склада ";
      const message3 = " клиенту ";
      const message4 = " объект ";
      const message5 = " по заявке ";
      const modal = document.querySelector('.modalMessage');
      modal.innerHTML = svgOk +
        `<div class='modalMessage_text'>${message1}<b>${data[1]}</b>${message2}<b>${data[0]}</b>${message3}<b>${data[3]}</b>${message4}<b>${data[4]}</b>${message5}<b>${data[5]}</b> записано в базу!</div><button id='buttonModalMessage' onClick='closeModalMessage(".newWriteOffPodmenaContainer")'>OK</button>`;
      modal.style.display = "flex";
      document.getElementById('buttonModalMessage').focus();
    }
    if (func === 'PrintZIP'){
      document.querySelector('.back').style.zIndex = 13;
      document.querySelector('.back').style.display = "none";
      document.querySelector('.PrintZIPContainer').style.display = "none";
      const dataSerial = list.listZIP.filter(item => item[3])
      const dataNotSerial = list.listZIP.filter(item => !item[3])
      const unique = [...new Set(dataNotSerial.map(item => item[0]))]
      const arrNotSerial = unique.map(item => {
        const countData = dataNotSerial.filter(value => value[0] === item)
        return [countData[0][0], countData[0][1], countData.length]
      })
      const dataListNotSerial = arrNotSerial.map((item, i) => {return `<tr>
        <td>${i+1}</td>
        <td>${item[0]}</td>
        <td>${item[1]}</td>
        <td>-</td>
        <td>шт</td>
        <td>${item[2]}</td>
      </tr>`}).join('')
      const dataListSerial = dataSerial.map((item, i) => {return `<tr>
        <td>${i+arrNotSerial.length+1}</td>
        <td>${item[0]}</td>
        <td>${item[1]}</td>
        <td>${item[3]}</td>
        <td>шт</td>
        <td>1</td>
      </tr>`}).join('')
      const dataList = [dataListNotSerial, dataListSerial].join('')
      preparePrintData(data, dataList)
    }
    if (func === 'PrintPodmena'){
      document.querySelector('.back').style.zIndex = 13;
      document.querySelector('.back').style.display = "none";
      document.querySelector('.PrintPodmenaContainer').style.display = "none";
      const dataList = list.listPodmena.map((item, i) => {return `<tr>
          <td>${i+1}</td>
          <td>${item[0]}</td>
          <td>${item[1]}</td>
          <td>${item[2]}</td>
          <td>шт</td>
          <td>1</td>
        </tr>`}).join('')
      preparePrintData(data, dataList)
    }
    if (func === 'PrintAll'){
      document.querySelector('.back').style.zIndex = 13;
      document.querySelector('.back').style.display = "none";
      document.querySelector('.PrintAllContainer').style.display = "none";
      const dataSerial = list.listZIP.filter(item => item[3])
      const dataNotSerial = list.listZIP.filter(item => !item[3])
      const unique = [...new Set(dataNotSerial.map(item => item[0]))]
      const arrNotSerial = unique.map(item => {
        const countData = dataNotSerial.filter(value => value[0] === item)
        return [countData[0][0], countData[0][1], countData.length]
      })
      const dataListNotSerial = arrNotSerial.map((item, i) => {return `<tr>
        <td>${i+1}</td>
        <td>${item[0]}</td>
        <td>${item[1]}</td>
        <td>-</td>
        <td>шт</td>
        <td>${item[2]}</td>
      </tr>`}).join('')
      const dataListSerial = dataSerial.map((item, i) => {return `<tr>
        <td>${i+arrNotSerial.length+1}</td>
        <td>${item[0]}</td>
        <td>${item[1]}</td>
        <td>${item[3]}</td>
        <td>шт</td>
        <td>1</td>
      </tr>`}).join('')
      const dataListPodmena = list.listPodmena.map((item, i) => {return `<tr>
          <td>${i+1}</td>
          <td>${item[0]}</td>
          <td>${item[1]}</td>
          <td>${item[2]}</td>
          <td>шт</td>
          <td>1</td>
        </tr>`}).join('')
      const dataList = [dataListNotSerial, dataListSerial, dataListPodmena].join('')
      preparePrintData(data, dataList)
    }
    if (func === 'getDataListForNewArrivalZIP') {
      list[type] = data
      list.count++
      if (list.count >= list.fullLoad) {
        document.querySelector('.newArrivalZIPContainer').style.display = "flex";
        list.fullLoad = 0
        list.count = 0
      }
    }
    if (func === 'getDataListForNewArrivalPodmena') {
      list[type] = data
      list.count++
      if (list.count >= list.fullLoad) {
        document.querySelector('.newArrivalPodmenaContainer').style.display = "flex";
        list.fullLoad = 0
        list.count = 0
      }
    }
    if (func === 'getDataListForNewMovingZIP') {
      list[type] = data
      list.count++
      if (list.count >= list.fullLoad) {
        document.querySelector('.newMovingZIPContainer').style.display = "flex";
        list.fullLoad = 0
        list.count = 0
      }
    }
    if (func === 'getDataListForNewMovingPodmena') {
      list[type] = data
      list.count++
      if (list.count >= list.fullLoad) {
        document.querySelector('.newMovingPodmenaContainer').style.display = "flex";
        list.fullLoad = 0
        list.count = 0
      }
    }
    if (func === 'getDataListForWriteOffZIP') {
      list[type] = data
      list.count++
      if (list.count >= list.fullLoad) {
        document.querySelector('.newWriteOffZIPContainer').style.display = "flex";
        list.fullLoad = 0
        list.count = 0
      }
    }
    if (func === 'getDataListForWriteOffPodmena') {
      list[type] = data
      list.count++
      if (list.count >= list.fullLoad) {
        document.querySelector('.newWriteOffPodmenaContainer').style.display = "flex";
        list.fullLoad = 0
        list.count = 0
      }
    }
    if (func === 'getDataListForPrintZIP') {
      list[type] = data
      list.count++
      if (list.count >= list.fullLoad) {
        document.querySelector('.PrintZIPContainer').style.display = "flex";
        list.fullLoad = 0
        list.count = 0
      }
    }
    if (func === 'getDataListForPrintPodmena') {
      list[type] = data
      list.count++
      if (list.count >= list.fullLoad) {
        document.querySelector('.PrintPodmenaContainer').style.display = "flex";
        list.fullLoad = 0
        list.count = 0
      }
    }
    if (func === 'getDataListForPrintAll') {
      list[type] = data
      list.count++
      if (list.count >= list.fullLoad) {
        document.querySelector('.PrintAllContainer').style.display = "flex";
        list.fullLoad = 0
        list.count = 0
      }
    }
    if (func === 'getDataListForReportZip') {
      list[type] = data
      list.count++
      if (list.count >= list.fullLoad) {
        document.querySelector('.dataZIPContainer').style.display = "flex";
        list.fullLoad = 0
        list.count = 0
      }
    }
    if (func === 'getDataListForReportPodmena') {
      list[type] = data
      list.count++
      if (list.count >= list.fullLoad) {
        document.querySelector('.dataPodmenaContainer').style.display = "flex";
        list.fullLoad = 0
        list.count = 0
      }
    }
    if (func === 'getDataListForReportWarehouse') {
      list[type] = data
      list.count++
      if (list.count >= list.fullLoad) {
        document.querySelector('.dataWarehouseContainer').style.display = "flex";
        list.fullLoad = 0
        list.count = 0
      }
    }
    if (func === 'gedDataforReport'){
      list[type] = data
      createData(option.item, option.label)
      document.querySelector('.back').style.zIndex = 13;
    }
 }

  function closeModalMessage(container) {
    document.querySelector('.modalMessage').style.display = "none";
    document.querySelector('.back').style.display = "none";
    document.querySelector('.back').style.zIndex = 13;
    document.querySelector(container).style.display = "none";
  }

  function newArrivalZIP() {
    zeroingList()
    document.querySelector('.back').style.display = "block";
    list.fullLoad = 5
    onSuccess({
      result: 'success',
      func: 'getDataListForNewArrivalZIP',
      data: ['Перекресток', 'Азбука вкуса', 'Лента', 'Мираторг'],
      type: 'listClient'
    })
    onSuccess({
      result: 'success',
      func: 'getDataListForNewArrivalZIP',
      data: ['Весы',
        'ФР',
        'ФН',
        'ИБП',
        'Кассовое оборудование',
        'Прочее',
        'Сетевое оборудование',
        'Оргтехника',
        'Прайсчекеры',
        'Термопринтеры'
      ],
      type: 'listClassifier'
    })
    onSuccess({
      result: 'success',
      func: 'getDataListForNewArrivalZIP',
      data: [
        ['Digi', 'Весы'],
        ['Атол-77Ф', 'ФР'],
        ['Retail 01Ф', 'ФР'],
        ['DataPrint', 'Весы'],
        ['Noname', 'ИБП'],
        ['Dosmar', 'Кассовое оборудование'],
        ['A-data', 'Прочее'],
        ['Noname', 'Прочее'],
        ['Noname', 'ФН'],
        ['СП-802', 'ФР'],
        ['Netac', 'Прочее'],
        ['AMD', 'Прочее'],
        ['ChWay', 'Кассовое оборудование'],
        ['ФН-1.2_Х5', 'ФН']
      ],
      type: 'prepareListModel'
    })
    onSuccess({
      result: 'success',
      func: 'getDataListForNewArrivalZIP',
      data: [
        ['Кабель от Raspberry к принтеру весов DP 403213', 'Весы', 'DP'],
        ['Кабель питания принтера для весов DP 30503489', 'Весы', 'DP'],
        ['Кассета для весов Dibal M525/D900', 'Весы', 'Dibal'],
        ['Кассета для Dibal 500', 'Весы', 'Digi'],
        ['Кассета для Digi SM100', 'Весы', 'Digi'],
        ['Кассета для Digi SM5000bs', 'Весы', 'Digi'],
        ['Аккумулятор для ИБП', 'ИБП', 'Noname'],
        ['Кабель USB type A ext PWR 15', 'Прочее', 'Noname'],
        ['Шлейф для подключения ФН', 'ФН', 'Noname']
      ],
      type: 'prepareListZIP'
    })
    onSuccess({
      result: 'success',
      func: 'getDataListForNewArrivalZIP',
      data: ['офис СБИ', 'Клиент', 'Лапкин Е.В.', 'Четов П.А.'],
      type: 'listWarehouses'
    })
    // google.script.run
    //   .withSuccessHandler(onSuccess)
    //   .getClients('getDataListForNewArrivalZIP','listClient')
    // google.script.run
    //   .withSuccessHandler(onSuccess)
    //   .getСlassifier('getDataListForNewArrivalZIP','listClassifier')
    // google.script.run
    //   .withSuccessHandler(onSuccess)
    //   .getModel('getDataListForNewArrivalZIP','prepareListModel')
    // google.script.run
    //   .withSuccessHandler(onSuccess)
    //   .getModel('getDataListForNewArrivalZIP','listWarehouses')
  }

  function newArrivalPodmena() {
    zeroingList()
    document.querySelector('.back').style.display = "block";
    list.fullLoad = 4
    onSuccess({
      result: 'success',
      func: 'getDataListForNewArrivalPodmena',
      data: ['Перекресток', 'Азбука вкуса', 'Лента', 'Мираторг'],
      type: 'listClient'
    })
    onSuccess({
      result: 'success',
      func: 'getDataListForNewArrivalPodmena',
      data: ['Весы',
        'ФР',
        'ФН',
        'ИБП',
        'Кассовое оборудование',
        'Прочее',
        'Сетевое оборудование',
        'Оргтехника',
        'Прайсчекеры',
        'Термопринтеры'
      ],
      type: 'listClassifier'
    })
    onSuccess({
      result: 'success',
      func: 'getDataListForNewArrivalPodmena',
      data: [
        ['Весы штрих PC200C3 V4 15-2.5', 'Весы'],
        ['Весы D-900 DIBAL (31760925)', 'Весы'],
        ['Digi SM100PCS+WLAN', 'Весы'],
        ['Дисплей покупателя CheckWay CD-13', 'Кассовое оборудование'],
        ['Кассовый комплект Beetle/M-III01 с верт ДЯ', 'Кассовое оборудование'],
        ['Ручной сканер 2D Symbol DS2208  ', 'Кассовое оборудование'],
        ['Принтер Kyocera FS-1060DN', 'Оргтехника'],
        ['Kyocera_M2040dn принтер', 'Оргтехника']
      ],
      type: 'prepareListPodmena'
    })
    onSuccess({
      result: 'success',
      func: 'getDataListForNewArrivalPodmena',
      data: ['офис СБИ', 'Клиент', 'Лапкин Е.В.', 'Четов П.А.'],
      type: 'listWarehouses'
    })
    // google.script.run
    //   .withSuccessHandler(onSuccess)
    //   .getClients('getDataListForNewArrivalPodmena','listClient')
    // google.script.run
    //   .withSuccessHandler(onSuccess)
    //   .getСlassifier('getDataListForNewArrivalPodmena','listClassifier')
    // google.script.run
    //   .withSuccessHandler(onSuccess)
    //   .getModel('getDataListForNewArrivalPodmena','listWarehouses')
  }

  function newMovingZIP() {
    zeroingList()
    document.querySelector('.back').style.display = "block";
    list.fullLoad = 2
    onSuccess({
      result: 'success',
      func: 'getDataListForNewMovingZIP',
      data: ['Офис СБИ', 'Гасанов', 'Платонов', 'Камалов'],
      type: 'listWarehouses'
    })
    onSuccess({
      result: 'success',
      func: 'getDataListForNewMovingZIP',
      data: [
        ['Термоголовка для весов DP, 30303022', 'Весы', 'DataPrint', '', 'Офис СБИ'],
        ['Термоголовка для весов DP, 30303022', 'Весы', 'DataPrint', '', 'Офис СБИ'],
        ['Термоголовка для весов DP, 30303022', 'Весы', 'DataPrint', '', 'Офис СБИ'],
        ['Термоголовка для весов DP, 30303022', 'Весы', 'DataPrint', '', 'Офис СБИ'],
        ['ФН-1.2_Х5', 'ФН', 'ФН-1.2_Х5', '123456', 'Офис СБИ'],
        ['ФН-1.2_Х5', 'ФН', 'ФН-1.2_Х5', '123457', 'Офис СБИ'],
        ['ФН-1.2_Х5', 'ФН', 'ФН-1.2_Х5', '123458', 'Офис СБИ'],
        ['ФН-1.2_Х5', 'ФН', 'ФН-1.2_Х5', '123459', 'Офис СБИ'],
        ['ФН-1.2_Х5', 'ФН', 'ФН-1.2_Х5', '123460', 'Офис СБИ'],
        ['ФН-1.2_Х5', 'ФН', 'ФН-1.2_Х5', '123461', 'Офис СБИ'],
        ['ФН-1.2_Х5', 'ФН', 'ФН-1.2_Х5', '123462', 'Офис СБИ'],
        ['ФН-1.2_Х5', 'ФН', 'ФН-1.2_Х5', '123463', 'Офис СБИ'],
        ['ФН-1.2_Х5', 'ФН', 'ФН-1.2_Х5', '123464', 'Офис СБИ'],
        ['ФН-1.2_Х5', 'ФН', 'ФН-1.2_Х5', '123465', 'Офис СБИ']
      ],
      type: 'prepareListZIP'
    })
    // google.script.run
    //   .withSuccessHandler(onSuccess)
    //   .getWarehouses('getDataListForNewMovingZIP','listWarehouses')
    // google.script.run
    //   .withSuccessHandler(onSuccess)
    //   .getZIPonWarehouses('getDataListForNewMovingZIP','prepareListZIP')
  }

  function newMovingPodmena() {
    zeroingList()
    document.querySelector('.back').style.display = "block";
    list.fullLoad = 2
    onSuccess({
      result: 'success',
      func: 'getDataListForNewMovingPodmena',
      data: ['Офис СБИ', 'Гасанов', 'Платонов', 'Камалов'],
      type: 'listWarehouses'
    })
    onSuccess({
      result: 'success',
      func: 'getDataListForNewMovingPodmena',
      data: [
        ['Digi SM100PCS+WLAN', 'Весы',  '647854531321', 'Офис СБИ'],
        ['Digi SM100PCS+WLAN', 'Весы',  '647854531323', 'Офис СБИ'],
        ['Digi SM100PCS+WLAN', 'Весы',  '647854531327', 'Офис СБИ'],
        ['Весы D-900 DIBAL (31760925)', 'Весы', '456789456', 'Офис СБИ'],
        ['Весы D-900 DIBAL (31760925)', 'Весы', '456878913', 'Офис СБИ'],
      ],
      type: 'prepareListPodmena'
    })
    // google.script.run
    //   .withSuccessHandler(onSuccess)
    //   .getWarehouses('getDataListForNewMovingPodmena','listWarehouses')
    // google.script.run
    //   .withSuccessHandler(onSuccess)
    //   .getPodmenaonWarehouses('getDataListForNewMovingPodmena','prepareListPodmena')
  }

  function writeOffZIP() {
    zeroingList()
    document.querySelector('.back').style.display = "block";
    list.fullLoad = 4
    onSuccess({
      result: 'success',
      func: 'getDataListForWriteOffZIP',
      data: ['офис СБИ', 'Клиент', 'Лапкин Е.В.', 'Гасанов Х.Н.'],
      type: 'listWarehouses'
    })
    onSuccess({
      result: 'success',
      func: 'getDataListForWriteOffZIP',
      data: [
        ['ФН-1.2_Х5', 'ФН', 'ФН-1.2_Х5', 64567897993, 'Гасанов Х.Н.', '30.10.2024 13:29:: evglapkin@gmail.com:: Поступление: АСЦН -> Офис СБИ', 'Выдали Платонову', 'https://drive.google.com/file/d/1sbCgxLXQ8eIFOD4hbzKoCKIe79SFx8PW/view?usp=drivesdk', '31.10.2024 14:05:: evglapkin@gmail.com:: Перемещение: Офис СБИ -> Гасанов Х.Н.', '', '', '', ''],
        ['ФН-1.2_Х5', 'ФН', 'ФН-1.2_Х5', 64567897994, 'Гасанов Х.Н.', '30.10.2024 13:29:: evglapkin@gmail.com:: Поступление: АСЦН -> Офис СБИ', 'Выдали Платонову', 'https://drive.google.com/file/d/1sbCgxLXQ8eIFOD4hbzKoCKIe79SFx8PW/view?usp=drivesdk', '31.10.2024 14:05:: evglapkin@gmail.com:: Перемещение: Офис СБИ -> Гасанов Х.Н.', '', '', '', ''],
        ['ФН-1.2_Х5', 'ФН', 'ФН-1.2_Х5', 64567897993, 'Гасанов Х.Н.', '30.10.2024 13:29:: evglapkin@gmail.com:: Поступление: АСЦН -> Офис СБИ', 'Выдали Платонову', 'https://drive.google.com/file/d/1sbCgxLXQ8eIFOD4hbzKoCKIe79SFx8PW/view?usp=drivesdk', '31.10.2024 14:05:: evglapkin@gmail.com:: Перемещение: Офис СБИ -> Гасанов Х.Н.', '', '', '', ''],
        ['Термоголовка для весов DP, 30303022', 'Весы', 'DataPrint', '', 'Гасанов Х.Н.', '30.10.2024 13:29:: evglapkin@gmail.com:: Поступление: АСЦН -> Офис СБИ', 'Выдали Платонову', 'https://drive.google.com/file/d/1sbCgxLXQ8eIFOD4hbzKoCKIe79SFx8PW/view?usp=drivesdk', '31.10.2024 14:05:: evglapkin@gmail.com:: Перемещение: Офис СБИ -> Гасанов Х.Н.', '', '', '', ''],
        ['Термоголовка для весов DP, 30303022', 'Весы', 'DataPrint', '', 'Гасанов Х.Н.', '30.10.2024 13:29:: evglapkin@gmail.com:: Поступление: АСЦН -> Офис СБИ', 'Выдали Платонову', 'https://drive.google.com/file/d/1sbCgxLXQ8eIFOD4hbzKoCKIe79SFx8PW/view?usp=drivesdk', '31.10.2024 14:05:: evglapkin@gmail.com:: Перемещение: Офис СБИ -> Гасанов Х.Н.', '', '', '', ''],
        ['Термоголовка для весов DP, 30303022', 'Весы', 'DataPrint', '', 'Гасанов Х.Н.', '30.10.2024 13:29:: evglapkin@gmail.com:: Поступление: АСЦН -> Офис СБИ', 'Выдали Платонову', 'https://drive.google.com/file/d/1sbCgxLXQ8eIFOD4hbzKoCKIe79SFx8PW/view?usp=drivesdk', '31.10.2024 14:05:: evglapkin@gmail.com:: Перемещение: Офис СБИ -> Гасанов Х.Н.', '', '', '', ''],
        ['Кабель питания принтера для весов ', 'Весы', 'DataPrint', '', 'Гасанов Х.Н.', '30.10.2024 13:29:: evglapkin@gmail.com:: Поступление: АСЦН -> Офис СБИ', 'Выдали Платонову', 'https://drive.google.com/file/d/1sbCgxLXQ8eIFOD4hbzKoCKIe79SFx8PW/view?usp=drivesdk', '31.10.2024 14:05:: evglapkin@gmail.com:: Перемещение: Офис СБИ -> Гасанов Х.Н.', '', '', '', ''],
        ['Кабель питания принтера для весов ', 'Весы', 'DataPrint', '', 'Гасанов Х.Н.', '30.10.2024 13:29:: evglapkin@gmail.com:: Поступление: АСЦН -> Офис СБИ', 'Выдали Платонову', 'https://drive.google.com/file/d/1sbCgxLXQ8eIFOD4hbzKoCKIe79SFx8PW/view?usp=drivesdk', '31.10.2024 14:05:: evglapkin@gmail.com:: Перемещение: Офис СБИ -> Гасанов Х.Н.', '', '', '', ''],
      ],
      type: 'prepareListZIP'
    })
    onSuccess({
      result: 'success',
      func: 'getDataListForWriteOffZIP',
      data: ['Перекресток', 'Азбука вкуса', 'Лента', 'Мираторг'],
      type: 'listClient'
    })
    onSuccess({
      result: 'success',
      func: 'getDataListForWriteOffZIP',
      data:[['Перекресток', 'Перекресток Калуга Суворова', 'г. Калуга, ул Суворова, д.113'],
            ['Перекресток', 'Перекресток Калуга Пролетарский', 'г. Калуга, ул Пролетарская, д.108'],
            ['Перекресток', 'Перекресток Бакинских Комиссаров', 'г. Москва, ул Бакинских Комиссаров, д.108']],
      type: 'prepareListObject'
    })
    // google.script.run
    //   .withSuccessHandler(onSuccess)
    //   .getClients('getDataListForNewArrivalZIP','listClient')
    // google.script.run
    //   .withSuccessHandler(onSuccess)
    //   .getСlassifier('getDataListForNewArrivalZIP','listClassifier')
    // google.script.run
    //   .withSuccessHandler(onSuccess)
    //   .getModel('getDataListForNewArrivalZIP','prepareListModel')
    // google.script.run
    //   .withSuccessHandler(onSuccess)
    //   .getModel('getDataListForNewArrivalZIP','listWarehouses')
  }

  function writeOffPodmena() {
    zeroingList()
    document.querySelector('.back').style.display = "block";
    list.fullLoad = 4
    onSuccess({
      result: 'success',
      func: 'getDataListForWriteOffPodmena',
      data: ['офис СБИ', 'Клиент', 'Лапкин Е.В.', 'Гасанов Х.Н.'],
      type: 'listWarehouses'
    })
    onSuccess({
      result: 'success',
      func: 'getDataListForWriteOffPodmena',
      data: [
        ['Термоголовка для весов DP, 30303022', 'Весы', 64567897993, 'Гасанов Х.Н.', '30.10.2024 13:29:: evglapkin@gmail.com:: Поступление: АСЦН -> Офис СБИ', 'Выдали Платонову', 'https://drive.google.com/file/d/1sbCgxLXQ8eIFOD4hbzKoCKIe79SFx8PW/view?usp=drivesdk', '31.10.2024 14:05:: evglapkin@gmail.com:: Перемещение: Офис СБИ -> Гасанов Х.Н.', '', '', '', ''],
        ['Термоголовка для весов DP, 30303022', 'Весы', 64567897994, 'Гасанов Х.Н.', '30.10.2024 13:29:: evglapkin@gmail.com:: Поступление: АСЦН -> Офис СБИ', 'Выдали Платонову', 'https://drive.google.com/file/d/1sbCgxLXQ8eIFOD4hbzKoCKIe79SFx8PW/view?usp=drivesdk', '31.10.2024 14:05:: evglapkin@gmail.com:: Перемещение: Офис СБИ -> Гасанов Х.Н.', '', '', '', '']
      ],
      type: 'prepareListPodmena'
    })
    onSuccess({
      result: 'success',
      func: 'getDataListForWriteOffPodmena',
      data: ['Перекресток', 'Азбука вкуса', 'Лента', 'Мираторг'],
      type: 'listClient'
    })
    onSuccess({
      result: 'success',
      func: 'getDataListForWriteOffPodmena',
      data:[['Перекресток', 'Перекресток Калуга Суворова', 'г. Калуга, ул Суворова, д.113'],
            ['Перекресток', 'Перекресток Калуга Пролетарский', 'г. Калуга, ул Пролетарская, д.108'],
            ['Перекресток', 'Перекресток Бакинских Комиссаров', 'г. Москва, ул Бакинских Комиссаров, д.108']],
      type: 'prepareListObject'
    })
    // google.script.run
    //   .withSuccessHandler(onSuccess)
    //   .getClients('getDataListForNewArrivalZIP','listClient')
    // google.script.run
    //   .withSuccessHandler(onSuccess)
    //   .getСlassifier('getDataListForNewArrivalZIP','listClassifier')
    // google.script.run
    //   .withSuccessHandler(onSuccess)
    //   .getModel('getDataListForNewArrivalZIP','prepareListModel')
    // google.script.run
    //   .withSuccessHandler(onSuccess)
    //   .getModel('getDataListForNewArrivalZIP','listWarehouses')
  }

  function createDocumentZIP(){
    zeroingList()
    document.querySelector('.back').style.display = "block";
    list.fullLoad = 3
    onSuccess({
      result: 'success',
      func: 'getDataListForPrintZIP',
      data: ['Офис СБИ', 'Гасанов Х.Н.', 'Платонов', 'Камалов'],
      type: 'listWarehouses'
    })
    onSuccess({
      result: 'success',
      func: 'getDataListForPrintZIP',
      data: [
        ['ФН-1.2_Х5', 'ФН', 'ФН-1.2_Х5', 64567897993, 'Гасанов Х.Н.', '30.10.2024 13:29:: evglapkin@gmail.com:: Поступление: АСЦН -> Офис СБИ', 'Выдали Платонову', 'https://drive.google.com/file/d/1sbCgxLXQ8eIFOD4hbzKoCKIe79SFx8PW/view?usp=drivesdk', '31.10.2024 14:05:: evglapkin@gmail.com:: Перемещение: Офис СБИ -> Гасанов Х.Н.', '', '', '', ''],
        ['ФН-1.2_Х5', 'ФН', 'ФН-1.2_Х5', 64567897994, 'Гасанов Х.Н.', '30.10.2024 13:29:: evglapkin@gmail.com:: Поступление: АСЦН -> Офис СБИ', 'Выдали Платонову', 'https://drive.google.com/file/d/1sbCgxLXQ8eIFOD4hbzKoCKIe79SFx8PW/view?usp=drivesdk', '31.10.2024 14:05:: evglapkin@gmail.com:: Перемещение: Офис СБИ -> Гасанов Х.Н.', '', '', '', ''],
        ['ФН-1.2_Х5', 'ФН', 'ФН-1.2_Х5', 64567897993, 'Гасанов Х.Н.', '30.10.2024 13:29:: evglapkin@gmail.com:: Поступление: АСЦН -> Офис СБИ', 'Выдали Платонову', 'https://drive.google.com/file/d/1sbCgxLXQ8eIFOD4hbzKoCKIe79SFx8PW/view?usp=drivesdk', '31.10.2024 14:05:: evglapkin@gmail.com:: Перемещение: Офис СБИ -> Гасанов Х.Н.', '', '', '', ''],
        ['Термоголовка для весов DP, 30303022', 'Весы', 'DataPrint', '', 'Гасанов Х.Н.', '30.10.2024 13:29:: evglapkin@gmail.com:: Поступление: АСЦН -> Офис СБИ', 'Выдали Платонову', 'https://drive.google.com/file/d/1sbCgxLXQ8eIFOD4hbzKoCKIe79SFx8PW/view?usp=drivesdk', '31.10.2024 14:05:: evglapkin@gmail.com:: Перемещение: Офис СБИ -> Гасанов Х.Н.', '', '', '', ''],
        ['Термоголовка для весов DP, 30303022', 'Весы', 'DataPrint', '', 'Гасанов Х.Н.', '30.10.2024 13:29:: evglapkin@gmail.com:: Поступление: АСЦН -> Офис СБИ', 'Выдали Платонову', 'https://drive.google.com/file/d/1sbCgxLXQ8eIFOD4hbzKoCKIe79SFx8PW/view?usp=drivesdk', '31.10.2024 14:05:: evglapkin@gmail.com:: Перемещение: Офис СБИ -> Гасанов Х.Н.', '', '', '', ''],
        ['Термоголовка для весов DP, 30303022', 'Весы', 'DataPrint', '', 'Гасанов Х.Н.', '30.10.2024 13:29:: evglapkin@gmail.com:: Поступление: АСЦН -> Офис СБИ', 'Выдали Платонову', 'https://drive.google.com/file/d/1sbCgxLXQ8eIFOD4hbzKoCKIe79SFx8PW/view?usp=drivesdk', '31.10.2024 14:05:: evglapkin@gmail.com:: Перемещение: Офис СБИ -> Гасанов Х.Н.', '', '', '', ''],
        ['Кабель питания принтера для весов ', 'Весы', 'DataPrint', '', 'Гасанов Х.Н.', '30.10.2024 13:29:: evglapkin@gmail.com:: Поступление: АСЦН -> Офис СБИ', 'Выдали Платонову', 'https://drive.google.com/file/d/1sbCgxLXQ8eIFOD4hbzKoCKIe79SFx8PW/view?usp=drivesdk', '31.10.2024 14:05:: evglapkin@gmail.com:: Перемещение: Офис СБИ -> Гасанов Х.Н.', '', '', '', ''],
        ['Кабель питания принтера для весов ', 'Весы', 'DataPrint', '', 'Гасанов Х.Н.', '30.10.2024 13:29:: evglapkin@gmail.com:: Поступление: АСЦН -> Офис СБИ', 'Выдали Платонову', 'https://drive.google.com/file/d/1sbCgxLXQ8eIFOD4hbzKoCKIe79SFx8PW/view?usp=drivesdk', '31.10.2024 14:05:: evglapkin@gmail.com:: Перемещение: Офис СБИ -> Гасанов Х.Н.', '', '', '', ''],
      ],
      type: 'prepareListZIP'
    })
    onSuccess({
      result: 'success',
      func: 'getDataListForPrintZIP',
      data: 13,
      type: 'actNumber'
    })
    // google.script.run
    //   .withSuccessHandler(onSuccess)
    //   .getWarehouses('getDataListForPrintZIP','listWarehouses')
  }

  function createDocumentPodmena(){
    zeroingList()
    document.querySelector('.back').style.display = "block";
    list.fullLoad = 1
    onSuccess({
      result: 'success',
      func: 'getDataListForPrintPodmena',
      data: ['Офис СБИ', 'Гасанов Х.Н.', 'Платонов', 'Камалов'],
      type: 'listWarehouses'
    })
    onSuccess({
      result: 'success',
      func: 'getDataListForPrintPodmena',
      data: [
        ['Термоголовка для весов DP, 30303022', 'Весы', 64567897993, 'Гасанов Х.Н.', '30.10.2024 13:29:: evglapkin@gmail.com:: Поступление: АСЦН -> Офис СБИ', 'Выдали Платонову', 'https://drive.google.com/file/d/1sbCgxLXQ8eIFOD4hbzKoCKIe79SFx8PW/view?usp=drivesdk', '31.10.2024 14:05:: evglapkin@gmail.com:: Перемещение: Офис СБИ -> Гасанов Х.Н.', '', '', '', ''],
        ['Термоголовка для весов DP, 30303022', 'Весы', 64567897994, 'Гасанов Х.Н.', '30.10.2024 13:29:: evglapkin@gmail.com:: Поступление: АСЦН -> Офис СБИ', 'Выдали Платонову', 'https://drive.google.com/file/d/1sbCgxLXQ8eIFOD4hbzKoCKIe79SFx8PW/view?usp=drivesdk', '31.10.2024 14:05:: evglapkin@gmail.com:: Перемещение: Офис СБИ -> Гасанов Х.Н.', '', '', '', '']
      ],
      type: 'prepareListPodmena'
    })
    onSuccess({
      result: 'success',
      func: 'getDataListForPrintPodmena',
      data: 12,
      type: 'actNumber'
    })
    // google.script.run
    //   .withSuccessHandler(onSuccess)
    //   .getWarehouses('getDataListForPrintPodmena','listWarehouses')
  }

  function createDocumentAll(){
    zeroingList()
    document.querySelector('.back').style.display = "block";
    list.fullLoad = 4
    onSuccess({
      result: 'success',
      func: 'getDataListForPrintAll',
      data: ['Офис СБИ', 'Гасанов Х.Н.', 'Платонов', 'Камалов'],
      type: 'listWarehouses'
    })
    onSuccess({
      result: 'success',
      func: 'getDataListForPrintAll',
      data: [
        ['ФН-1.2_Х5', 'ФН', 'ФН-1.2_Х5', 64567897993, 'Гасанов Х.Н.', '30.10.2024 13:29:: evglapkin@gmail.com:: Поступление: АСЦН -> Офис СБИ', 'Выдали Платонову', 'https://drive.google.com/file/d/1sbCgxLXQ8eIFOD4hbzKoCKIe79SFx8PW/view?usp=drivesdk', '31.10.2024 14:05:: evglapkin@gmail.com:: Перемещение: Офис СБИ -> Гасанов Х.Н.', '', '', '', ''],
        ['ФН-1.2_Х5', 'ФН', 'ФН-1.2_Х5', 64567897994, 'Гасанов Х.Н.', '30.10.2024 13:29:: evglapkin@gmail.com:: Поступление: АСЦН -> Офис СБИ', 'Выдали Платонову', 'https://drive.google.com/file/d/1sbCgxLXQ8eIFOD4hbzKoCKIe79SFx8PW/view?usp=drivesdk', '31.10.2024 14:05:: evglapkin@gmail.com:: Перемещение: Офис СБИ -> Гасанов Х.Н.', '', '', '', ''],
        ['ФН-1.2_Х5', 'ФН', 'ФН-1.2_Х5', 64567897993, 'Гасанов Х.Н.', '30.10.2024 13:29:: evglapkin@gmail.com:: Поступление: АСЦН -> Офис СБИ', 'Выдали Платонову', 'https://drive.google.com/file/d/1sbCgxLXQ8eIFOD4hbzKoCKIe79SFx8PW/view?usp=drivesdk', '31.10.2024 14:05:: evglapkin@gmail.com:: Перемещение: Офис СБИ -> Гасанов Х.Н.', '', '', '', ''],
        ['Термоголовка для весов DP, 30303022', 'Весы', 'DataPrint', '', 'Гасанов Х.Н.', '30.10.2024 13:29:: evglapkin@gmail.com:: Поступление: АСЦН -> Офис СБИ', 'Выдали Платонову', 'https://drive.google.com/file/d/1sbCgxLXQ8eIFOD4hbzKoCKIe79SFx8PW/view?usp=drivesdk', '31.10.2024 14:05:: evglapkin@gmail.com:: Перемещение: Офис СБИ -> Гасанов Х.Н.', '', '', '', ''],
        ['Термоголовка для весов DP, 30303022', 'Весы', 'DataPrint', '', 'Гасанов Х.Н.', '30.10.2024 13:29:: evglapkin@gmail.com:: Поступление: АСЦН -> Офис СБИ', 'Выдали Платонову', 'https://drive.google.com/file/d/1sbCgxLXQ8eIFOD4hbzKoCKIe79SFx8PW/view?usp=drivesdk', '31.10.2024 14:05:: evglapkin@gmail.com:: Перемещение: Офис СБИ -> Гасанов Х.Н.', '', '', '', ''],
        ['Термоголовка для весов DP, 30303022', 'Весы', 'DataPrint', '', 'Гасанов Х.Н.', '30.10.2024 13:29:: evglapkin@gmail.com:: Поступление: АСЦН -> Офис СБИ', 'Выдали Платонову', 'https://drive.google.com/file/d/1sbCgxLXQ8eIFOD4hbzKoCKIe79SFx8PW/view?usp=drivesdk', '31.10.2024 14:05:: evglapkin@gmail.com:: Перемещение: Офис СБИ -> Гасанов Х.Н.', '', '', '', ''],
        ['Кабель питания принтера для весов ', 'Весы', 'DataPrint', '', 'Гасанов Х.Н.', '30.10.2024 13:29:: evglapkin@gmail.com:: Поступление: АСЦН -> Офис СБИ', 'Выдали Платонову', 'https://drive.google.com/file/d/1sbCgxLXQ8eIFOD4hbzKoCKIe79SFx8PW/view?usp=drivesdk', '31.10.2024 14:05:: evglapkin@gmail.com:: Перемещение: Офис СБИ -> Гасанов Х.Н.', '', '', '', ''],
        ['Кабель питания принтера для весов ', 'Весы', 'DataPrint', '', 'Гасанов Х.Н.', '30.10.2024 13:29:: evglapkin@gmail.com:: Поступление: АСЦН -> Офис СБИ', 'Выдали Платонову', 'https://drive.google.com/file/d/1sbCgxLXQ8eIFOD4hbzKoCKIe79SFx8PW/view?usp=drivesdk', '31.10.2024 14:05:: evglapkin@gmail.com:: Перемещение: Офис СБИ -> Гасанов Х.Н.', '', '', '', ''],
      ],
      type: 'prepareListZIP'
    })
    onSuccess({
      result: 'success',
      func: 'getDataListForPrintAll',
      data: [
        ['Термоголовка для весов DP, 30303022', 'Весы', 64567897993, 'Гасанов Х.Н.', '30.10.2024 13:29:: evglapkin@gmail.com:: Поступление: АСЦН -> Офис СБИ', 'Выдали Платонову', 'https://drive.google.com/file/d/1sbCgxLXQ8eIFOD4hbzKoCKIe79SFx8PW/view?usp=drivesdk', '31.10.2024 14:05:: evglapkin@gmail.com:: Перемещение: Офис СБИ -> Гасанов Х.Н.', '', '', '', ''],
        ['Термоголовка для весов DP, 30303022', 'Весы', 64567897994, 'Гасанов Х.Н.', '30.10.2024 13:29:: evglapkin@gmail.com:: Поступление: АСЦН -> Офис СБИ', 'Выдали Платонову', 'https://drive.google.com/file/d/1sbCgxLXQ8eIFOD4hbzKoCKIe79SFx8PW/view?usp=drivesdk', '31.10.2024 14:05:: evglapkin@gmail.com:: Перемещение: Офис СБИ -> Гасанов Х.Н.', '', '', '', '']
      ],
      type: 'prepareListPodmena'
    })
    onSuccess({
      result: 'success',
      func: 'getDataListForPrintAll',
      data: 13,
      type: 'actNumber'
    })
    // google.script.run
    //   .withSuccessHandler(onSuccess)
    //   .getWarehouses('getDataListForPrintPodmena','listWarehouses')
  }

  function reportZIP(){
    zeroingList()
    document.querySelector('.back').style.display = "block";
    const isDataForm = document.querySelector('.dataForm')
    if (isDataForm) {
      isDataForm.remove()
    }
    list.fullLoad = 1
    onSuccess({
      result: 'success',
      func: 'getDataListForReportZip',
      data: [['ФН-1.2_Х5'], ['Термоголовка для весов DP, 30303022'], ['Кабель питания принтера для весов ']],
      type: 'listZip'
    })
  }

  function reportPodmena(){
    zeroingList()
    document.querySelector('.back').style.display = "block";
    const isDataForm = document.querySelector('.dataForm')
    if (isDataForm) {
      isDataForm.remove()
    }
    list.fullLoad = 1
    onSuccess({
      result: 'success',
      func: 'getDataListForReportPodmena',
      data: [['ФН-1.2_Х5'], ['Термоголовка для весов DP, 30303022'], ['Кабель питания принтера для весов ']],
      type: 'listPodmena'
    })
  }

  function reportWarehouse(){
    zeroingList()
    document.querySelector('.back').style.display = "block";
    const isDataForm = document.querySelector('.dataForm')
    if (isDataForm) {
      isDataForm.remove()
    }
    list.fullLoad = 1
    onSuccess({
      result: 'success',
      func: 'getDataListForReportWarehouse',
      data: [['Офис СБИ'],
      ['Офис СБИ'],
      ['Гасанов Х.Н.'],
      ['Офис СБИ'],
      ['Перекресток'],
      ['Перекресток'],
      ['Гасанов Х.Н.'],
      ['Офис СБИ'],
      ['Офис СБИ']],
      type: 'listWarehouses'
    })
  }

  function gedDataforReport(item, label){
    document.querySelector('.back').style.zIndex = 88;
    const isDataForm = document.querySelector('.dataForm')
    if (isDataForm) {
      isDataForm.remove()
    }
    if (label === 'ЗИП'){
      onSuccess({
        result: 'success',
        func: 'gedDataforReport',
        data: [['Офис СБИ'],
              ['Офис СБИ'],
              ['Гасанов Х.Н.'],
              ['Гасанов Х.Н.'],
              ['Офис СБИ'],
              ['Офис СБИ']],
        type: 'reportData',
        option: {item, label}
      })
    }
    if (label === 'Подмена'){
      onSuccess({
        result: 'success',
        func: 'gedDataforReport',
        data: [['Офис СБИ'],
              ['Офис СБИ'],
              ['Гасанов Х.Н.'],
              ['Офис СБИ'],
              ['Офис СБИ'],
              ['Офис СБИ']],
        type: 'reportData',
        option: {item, label}
      })
    }
    if (label === 'Склад'){
      onSuccess({
        result: 'success',
        func: 'gedDataforReport',
        data: [['Офис СБИ'],
              ['Гасанов Х.Н.'],
              ['Гасанов Х.Н.'],
              ['Гасанов Х.Н.'],
              ['Гасанов Х.Н.'],
              ['Офис СБИ']],
        type: 'reportData',
        option: {item, label}
      })
    }
  }

  document.addEventListener('mouseup', function (e) {
    const popover = document.querySelector('.popover')
    const inputClasses = e.target.classList
    if (popover && inputClasses) {
      if (!popover.contains(e.target) && !inputClasses.contains('inputPopover')) {
        const inputPopover = document.querySelector('.inputPopover')
        inputPopover.classList.remove('inputPopover')
        popover.remove();
        const inputsContainer = inputPopover.closest('.inputsContainer')
        inputsContainer.style.overflowY = 'overlay'
      }
      if (popover.contains(e.target) && e.srcElement.tagName === 'LI') {
        const inputPopover = document.querySelector('.inputPopover')
        if (inputPopover.name.includes('nArZ2')) {
          list['listModel'] = list.prepareListModel.filter(value => value[1] === e.target.innerText).map(value =>
            value[0])
          document.getElementById('nArZ3').value = ''
        }
        if (inputPopover.name.includes('nArZ3')) {
          const classifier = document.getElementById('nArZ2').value
          list['listZIP'] = list.prepareListZIP.filter(value => value[1] === classifier && value[2] === e.target
            .innerText).map(value =>
            value[0])
          document.getElementById('nArZ4').value = ''
        }
        if (inputPopover.name.includes('nArP2')) {
          list['listPodmena'] = list.prepareListPodmena.filter(value => value[1] === e.target.innerText).map(
            value =>
            value[0])
          document.getElementById('nArP3').value = ''
        }
        if (inputPopover.name.includes('nMvZ1')) {
          list['listSortZIP'] = list.prepareListZIP.filter(value => value[4] === e.target.innerText)
          list['listZIP'] = [... new Set(list['listSortZIP'].map(value => value[0]))]
          document.getElementById('nMvZ2').value = ''
          document.getElementById('nMvZ4').value = ''
        }
        if (inputPopover.name.includes('nMvZ2')) {
          const checkedZIP = list['listSortZIP'].filter(value => value[0] === e.target.innerText)
          const countZIP = checkedZIP.length
          const input = document.getElementById('nMvZ3')
          input.max = countZIP
          const inputSerial = document.getElementById('nMvZ4')
          inputSerial.value = ''
          const label = input.parentNode.previousElementSibling
          label.innerText = `Укажите количество* (всего на складе - ${countZIP})`
          list['listSerial'] = checkedZIP.filter(value => value[3]).map(value => value[3])
          if (list['listSerial'].length){
            input.disabled = true
            input.classList.add('disabled')
            inputSerial.required = true
            inputSerial.name = 'nMvZ4.textLightValidation'
          } else {
            if (input.classList.contains('disabled')){
              input.disabled = false
              input.classList.remove('disabled')
              inputSerial.required = false
              inputSerial.name = 'nMvZ4.textNoValidRequired'
            }
          }
          document.getElementById('nArP3').value = ''
        }
        if (inputPopover.name.includes('nMvP1')) {
          list['listSortPodmena'] = list.prepareListPodmena.filter(value => value[3] === e.target.innerText)
          list['listPodmena'] = [... new Set(list['listSortPodmena'].map(value => value[0]))]
          document.getElementById('nMvP2').value = ''
          document.getElementById('nMvP3').value = ''
        }
        if (inputPopover.name.includes('nMvP2')) {
          list['listSerial'] = list.listSortPodmena.filter(value => value[0] === e.target.innerText).map(value => value[2])
          document.getElementById('nMvP3').value = ''
        }
        if (inputPopover.name.includes('nWoZ1')) {
          list['listSortZIP'] = list.prepareListZIP.filter(value => value[4] === e.target.innerText)
          list['listZIP'] = [... new Set(list['listSortZIP'].map(value => value[0]))]
          document.getElementById('nWoZ2').value = ''
          document.getElementById('nWoZ4').value = ''
        }
        if (inputPopover.name.includes('nWoZ2')) {
          const checkedZIP = list['listSortZIP'].filter(value => value[0] === e.target.innerText)
          const countZIP = checkedZIP.length
          const input = document.getElementById('nWoZ3')
          input.max = countZIP
          const inputSerial = document.getElementById('nWoZ4')
          inputSerial.value = ''
          const label = input.parentNode.previousElementSibling
          label.innerText = `Укажите количество* (всего на складе - ${countZIP})`
          list['listSerial'] = checkedZIP.filter(value => value[3]).map(value => value[3])
          if (list['listSerial'].length){
            input.disabled = true
            input.classList.add('disabled')
            inputSerial.required = true
            inputSerial.name = 'nWoZ4.textLightValidation'
          } else {
            if (input.classList.contains('disabled')){
              input.disabled = false
              input.classList.remove('disabled')
              inputSerial.required = false
              inputSerial.name = 'nWoZ4.textNoValidRequired'
            }
          }
          document.getElementById('nWoZ4').value = ''
        }
        if (inputPopover.name.includes('nWoZ5')) {
          list['listObject'] = list.prepareListObject.filter(value => value[0] === e.target.innerText).map(value => value[1])
           document.getElementById('nWoZ6').value = ''
        }
        if (inputPopover.name.includes('nWoP1')) {
          list['listSortPodmena'] = list.prepareListPodmena.filter(value => value[3] === e.target.innerText)
          list['listPodmena'] = [... new Set(list['listSortPodmena'].map(value => value[0]))]
          document.getElementById('nWoP2').value = ''
          document.getElementById('nWoP3').value = ''
        }
        if (inputPopover.name.includes('nWoP2')) {
          list['listSerial'] = list.listSortPodmena.filter(value => value[0] === e.target.innerText).map(value => value[2])
          document.getElementById('nWoP3').value = ''
        }
        if (inputPopover.name.includes('nWoP4')) {
          list['listObject'] = list.prepareListObject.filter(value => value[0] === e.target.innerText).map(value => value[1])
           document.getElementById('nWoP5').value = ''
        }
        if (inputPopover.name.includes('nPrZ1')) {
          list['listZIP'] = list.prepareListZIP.filter(value => value[4] === e.target.innerText)
        }
        if (inputPopover.name.includes('nPrP1')) {
          list['listPodmena'] = list.prepareListPodmena.filter(value => value[3] === e.target.innerText)
        }
        if (inputPopover.name.includes('nPrA1')) {
          list['listZIP'] = list.prepareListZIP.filter(value => value[4] === e.target.innerText)
          list['listPodmena'] = list.prepareListPodmena.filter(value => value[3] === e.target.innerText)
        }
        if (inputPopover.name.includes('nDzC1')) {
          gedDataforReport(e.target.innerText, 'ЗИП')
        }
        if (inputPopover.name.includes('nDpC1')) {
          gedDataforReport(e.target.innerText, 'Подмена')
        }
        if (inputPopover.name.includes('nDwC1')) {
          gedDataforReport(e.target.innerText, 'Склад')
        }
        if (inputPopover.classList.contains('textareaOutlined')){
          const li = e.target
          if (inputPopover.value.includes(li.innerText)) {
            li.classList.remove('popoverKeySelected')
            inputPopover.value = inputPopover.value.includes(`\n${li.innerText}`) 
              ? inputPopover.value.replace(`\n${li.innerText}`,'') 
              : inputPopover.value.includes(`\n`) 
                ? inputPopover.value.replace(`${li.innerText}\n`,'') 
                : inputPopover.value.replace(li.innerText,'') 
          } else {
            li.classList.add('popoverKeySelected')
            inputPopover.value = inputPopover.value 
              ? `${inputPopover.value}\n${li.innerText}` 
              : li.innerText
          }
          const label = inputPopover.parentNode.previousElementSibling
          if (inputPopover.value && !label.classList.contains('inputLabelActive')) {
            label.classList.add('inputLabelActive')
          }
          if (!inputPopover.value && label.classList.contains('inputLabelActive')) {
            label.classList.remove('inputLabelActive')
          }
          inputPopover.focus()
        } else {
          inputPopover.value = e.target.innerText
          inputPopover.classList.remove('inputPopover')
          popover.remove();
          const label = inputPopover.parentNode.previousElementSibling
          label.classList.add('inputLabelActive')
          const inputError = inputPopover.parentNode.nextElementSibling
          inputError.textContent = ""
          const container = inputPopover.parentNode
          const svg = container.querySelector('.svgDropdownCross')
          if (inputPopover.value && !svg) {
            container.insertAdjacentHTML('beforeend', svgCrossDropdown)
          }
          const inputsContainer = inputPopover.closest('.inputsContainer')
          inputsContainer.style.overflowY = 'overlay'
        }
      }
    }
  })

  document.addEventListener('keydown', function (e) {
    const popoverUL = document.querySelector('.popover_listbox')
    if (popoverUL && e.target.classList.contains('inputPopover')) {
      const inputPopover = document.querySelector('.inputPopover')
      if (e.key === 'Tab') {
        e.preventDefault()
        return
      }
      if (inputPopover.classList.contains('textareaOutlined')) return
      const listOptions = document.querySelectorAll('[role="popover_option"]')
      const popoverKeyActive = Array.from(listOptions).findIndex(value => value.classList.value.includes(
        'popoverKeyActive'))
      if (e.key === 'ArrowDown') {
        if (popoverKeyActive < 0) {
          document.querySelectorAll('[role="popover_option"]:first-of-type')[0].classList.add('popoverKeyActive')
        }
        if (popoverKeyActive >= 0 && popoverKeyActive < listOptions.length - 1) {
          document.querySelectorAll('[role="popover_option"]')[popoverKeyActive].classList.remove(
            'popoverKeyActive')
          document.querySelectorAll('[role="popover_option"]')[popoverKeyActive + 1].classList.add(
            'popoverKeyActive')
        }
      }
      if (e.key === 'ArrowUp') {
        if (popoverKeyActive > 0) {
          const number = popoverKeyActive - 1
          document.querySelectorAll('[role="popover_option"]')[popoverKeyActive].classList.remove(
            'popoverKeyActive')
          document.querySelectorAll('[role="popover_option"]')[popoverKeyActive - 1].classList.add(
            'popoverKeyActive')
        }
      }
      if (e.key === 'Enter') {
        const option = document.querySelectorAll('[role="popover_option"]')[popoverKeyActive < 0 ? 0 :
          popoverKeyActive].innerText
        inputPopover.value = option
        if (inputPopover.name.includes('nArZ2')) {
          list['listModel'] = list.prepareListModel.filter(value => value[1] === option).map(value =>
            value[0])
          document.getElementById('nArZ3').value = ''
        }
        if (inputPopover.name.includes('nArZ3')) {
          const classifier = document.getElementById('nArZ2').value
          list['listZIP'] = list.prepareListZIP.filter(value => value[1] === classifier && value[2] === option).map(value =>
            value[0])
          document.getElementById('nArZ4').value = ''
        }
        if (inputPopover.name.includes('nArP2')) {
          list['listPodmena'] = list.prepareListPodmena.filter(value => value[1] === option).map(
            value =>
            value[0])
          document.getElementById('nArP3').value = ''
        }
        if (inputPopover.name.includes('nMvZ1')) {
          list['listSortZIP'] = list.prepareListZIP.filter(value => value[4] === option)
          list['listZIP'] = [... new Set(list['listSortZIP'].map(value => value[0]))]
          document.getElementById('nMvZ2').value = ''
          document.getElementById('nMvZ4').value = ''
        }
        if (inputPopover.name.includes('nMvZ2')) {
          const checkedZIP = list['listSortZIP'].filter(value => value[0] === option)
          const countZIP = checkedZIP.length
          const input = document.getElementById('nMvZ3')
          input.max = countZIP
          const inputSerial = document.getElementById('nMvZ4')
          inputSerial.value = ''
          const label = input.parentNode.previousElementSibling
          label.innerText = `Укажите количество* (всего на складе - ${countZIP})`
          list['listSerial'] = checkedZIP.filter(value => value[3]).map(value => value[3])
          if (list['listSerial'].length){
            input.disabled = true
            input.classList.add('disabled')
            inputSerial.required = true
            inputSerial.name = 'nMvZ4.textLightValidation'
          } else {
            if (input.classList.contains('disabled')){
              input.disabled = false
              input.classList.remove('disabled')
              inputSerial.required = false
              inputSerial.name = 'nMvZ4.textNoValidRequired'
            }
          }
          document.getElementById('nArP3').value = ''
        }
        if (inputPopover.name.includes('nMvP1')) {
          list['listSortPodmena'] = list.prepareListPodmena.filter(value => value[3] === option)
          list['listPodmena'] = [... new Set(list['listSortPodmena'].map(value => value[0]))]
          document.getElementById('nMvP2').value = ''
          document.getElementById('nMvP3').value = ''
        }
        if (inputPopover.name.includes('nMvP2')) {
          list['listSerial'] = list.listSortPodmena.filter(value => value[0] === option).map(value => value[2])
          document.getElementById('nMvP3').value = ''
        }
        if (inputPopover.name.includes('nWoZ1')) {
          list['listSortZIP'] = list.prepareListZIP.filter(value => value[4] === option)
          list['listZIP'] = [... new Set(list['listSortZIP'].map(value => value[0]))]
          document.getElementById('nWoZ2').value = ''
          document.getElementById('nWoZ4').value = ''
        }
        if (inputPopover.name.includes('nWoZ2')) {
          const checkedZIP = list['listSortZIP'].filter(value => value[0] === option)
          const countZIP = checkedZIP.length
          const input = document.getElementById('nWoZ3')
          input.max = countZIP
          const inputSerial = document.getElementById('nWoZ4')
          inputSerial.value = ''
          const label = input.parentNode.previousElementSibling
          label.innerText = `Укажите количество* (всего на складе - ${countZIP})`
          list['listSerial'] = checkedZIP.filter(value => value[3]).map(value => value[3])
          if (list['listSerial'].length){
            input.disabled = true
            input.classList.add('disabled')
            inputSerial.required = true
            inputSerial.name = 'nWoZ4.textLightValidation'
          } else {
            if (input.classList.contains('disabled')){
              input.disabled = false
              input.classList.remove('disabled')
              inputSerial.required = false
              inputSerial.name = 'nWoZ4.textNoValidRequired'
            }
          }
          document.getElementById('nWoZ4').value = ''
        }
        if (inputPopover.name.includes('nWoZ5')) {
          list['listObject'] = list.prepareListObject.filter(value => value[0] === option).map(value => value[1])
           document.getElementById('nWoZ6').value = ''
        }
        if (inputPopover.name.includes('nWoP1')) {
          list['listSortPodmena'] = list.prepareListPodmena.filter(value => value[3] === option)
          list['listPodmena'] = [... new Set(list['listSortPodmena'].map(value => value[0]))]
          document.getElementById('nWoP2').value = ''
          document.getElementById('nWoP3').value = ''
        }
        if (inputPopover.name.includes('nWoP2')) {
          list['listSerial'] = list.listSortPodmena.filter(value => value[0] === option).map(value => value[2])
          document.getElementById('nWoP3').value = ''
        }
        if (inputPopover.name.includes('nWoP4')) {
          list['listObject'] = list.prepareListObject.filter(value => value[0] === option).map(value => value[1])
           document.getElementById('nWoP5').value = ''
        }
        if (inputPopover.name.includes('nPrZ1')) {
          e.preventDefault()
          list['listZIP'] = list.prepareListZIP.filter(value => value[4] === option)
        }
        if (inputPopover.name.includes('nPrP1')) {
          e.preventDefault()
          list['listPodmena'] = list.prepareListPodmena.filter(value => value[3] === option)
        }
        if (inputPopover.name.includes('nPrA1')) {
          e.preventDefault()
          list['listZIP'] = list.prepareListZIP.filter(value => value[4] === option)
          list['listPodmena'] = list.prepareListPodmena.filter(value => value[3] === option)
        }
        if (inputPopover.name.includes('nDzC1')) {
          e.preventDefault()
          gedDataforReport(option, 'ЗИП')
        }
        if (inputPopover.name.includes('nDpC1')) {
          e.preventDefault()
          gedDataforReport(option, 'Подмена')
        }
        if (inputPopover.name.includes('nDwC1')) {
          e.preventDefault()
          gedDataforReport(option, 'Склад')
        }
        inputPopover.classList.remove('inputPopover')
        const popover = document.querySelector('.popover')
        popover.remove();
        const label = inputPopover.parentNode.previousElementSibling
        label.classList.add('inputLabelActive')
        const inputError = inputPopover.parentNode.nextElementSibling
        inputError.textContent = ""
        const container = inputPopover.parentNode
        const svg = container.querySelector('.svgDropdownCross')
        if (inputPopover.value && !svg) {
          container.insertAdjacentHTML('beforeend', svgCrossDropdown)
        }
        const inputsContainer = inputPopover.closest('.inputsContainer')
        inputsContainer.style.overflowY = 'overlay'
      }
    }
  })

  const inputOutlined = document.querySelectorAll('.inputOutlined')
  Array.from(inputOutlined).map((item, index) => {
    item.addEventListener('blur', function (e) {
      const input = e.target
      const label = input.parentNode.previousElementSibling
      const noElements = document.querySelector('.popoverNoElements')
      if (noElements) {
        input.value = ''
        input.classList.remove('inputPopover')
        const inputsContainer = input.closest('.inputsContainer')
        inputsContainer.style.overflowY = 'overlay'
        const popover = document.querySelector('.popover')
        popover.remove();
      }

      if (!input.value) {
        label.classList.remove('inputLabelActive')
      } else {
        label.classList.add('inputLabelActive')
      }
      let validate = ''
      if (input.name.includes('text')) {
        validate = textValidation(input.value)
      }
      if (input.name.includes('email')) {
        validate = emailValidation(input.value)
      }
      if (input.name.includes('number')) {
        validate = numberValidation(input.value)
      }
      if (input.name.includes('textRuEng')) {
        validate = textRuEngValidation(input.value)
      }
      if (input.name.includes('textCRDNT')) {
        validate = coordinatesValidation(input.value)
      }
      if (input.name.includes('textLightValidation')) {
        validate = textLightValidation(input.value)
      }
      if (input.name.includes('textNoValidRequired')) {
        validate = textNoValidRequired(input.value)
      }
      const inputError = input.parentNode.nextElementSibling
      if (!validate.status && inputError.textContent) {
        inputError.textContent = ""
      }
      if (validate.status) {
        inputError.textContent = validate.error
      }
      const inputsWarning = input.closest('form').querySelector('.inputsWarning')
      inputsWarning.innerText = ''
    })
  })

  const inputFile = document.querySelectorAll('.inputFile')
  Array.from(inputFile).map((item, index) => {
    item.addEventListener('change', function (e) {
      const input = e.target
      const inputError = input.parentNode.nextElementSibling
      if (input.files.length <= 10 && inputError.textContent) {
        inputError.textContent = ""
      }
      if (input.files.length > 10) {
        inputError.textContent = 'Не более 10 файлов!'
        input.value = ''
        return
      }
      const svg = input.querySelector('.svgFileClear')
      if (input.value && !svg) {
        input.style.color = '#C1EEE1'
        input.parentNode.parentNode.insertAdjacentHTML('beforeend', svgFileClear)
      }
      if (!input.value && svg) {
        input.querySelector('.svgFileClear').remove()
        input.style.color = '#ef5350'
      }
    })
  })

  function changeInputKeyDownDropDown(key, input, listType) {
    const popoverUL = document.querySelector('.popover_listbox')
    if (!popoverUL && key === 'ArrowDown') {
      createPopover(input, 'click', list[listType])
      changeInputDropDownCross(input)
    }
  }

  function changeInputClickDropDown(input, listType) {
    createPopover(input, 'click', list[listType])
    changeInputDropDownCross(input)
  }

  function changeInputDropDown(input, listType) {
    createPopover(input, 'input', list[listType])
    changeInputDropDownCross(input)
  }

  function changeInputDropDownCross(input) {
    const container = input.parentNode
    const svg = container.querySelector('.svgDropdownCross')
    if (input.value && !svg) {
      container.insertAdjacentHTML('beforeend', svgCrossDropdown)
    }
    if (!input.value && svg) {
      container.querySelector('.svgDropdownCross').remove()
    }
  }

  function createPopover(input, type, list) {
    const popover = document.querySelector('.popover')
    const inputsContainer = input.closest('.inputsContainer')
    if (input.classList.contains('inputPopover') && popover){
      popover.remove()
      input.classList.remove('inputPopover')
      inputsContainer.style.overflowY = 'overlay'
      return
    } 
    if (popover) {
      popover.remove()
      input.classList.remove('inputPopover')
    }
    inputsContainer.style.overflowY = 'hidden'
    const popoverdiv = document.createElement("div");
    popoverdiv.className = "popover";
    document.body.appendChild(popoverdiv);
    const popoverPaperdiv = document.createElement("div");
    popoverPaperdiv.className = "popover_paper";
    popoverdiv.appendChild(popoverPaperdiv)
    popoverdiv.style.display = "block";
    popoverdiv.style.width = `${input.parentNode.offsetWidth}px`
    popoverdiv.style.height = `${input.parentNode.offsetHeight}px`
    popoverdiv.style.transform =
      `translate(${input.getBoundingClientRect().left}px,${input.getBoundingClientRect().bottom}px)`
    input.classList.add('inputPopover')
    const listFilter = type === 'input' ? list.filter(value => value.toLocaleLowerCase().includes(input.value
      .toLocaleLowerCase()) || input.value === '') : list
    if (listFilter && listFilter.length) {
      const popoverUL = document.createElement("ul");
      popoverUL.className = "popover_listbox";
      popoverUL.role = "listbox"
      popoverUL.id = "popover_listbox"
      popoverPaperdiv.appendChild(popoverUL)
      popoverUL.style.minHeight = '75px'
      popoverUL.style.maxHeight = '140px'
      listFilter.map(
        (value,
          index) => {
          const popoverLi = document.createElement("li");
          popoverLi.role = "popover_option"
          popoverLi.id = `popover_option_${index}`
          popoverLi.innerText = value
          if (input.classList.contains('textareaOutlined')){
            if (input.value.includes(value)){
              popoverLi.className = 'popoverKeySelected'
            }
          } else {
            if (value === input.value) {
              popoverLi.className = 'popoverKeySelected'
            }
          }
          popoverUL.appendChild(popoverLi)
        })
      return
    }
    const popoverNoElements = document.createElement("div");
    popoverNoElements.innerText = 'Нет данных'
    popoverNoElements.className = 'popoverNoElements'
    popoverPaperdiv.appendChild(popoverNoElements)
  }

  function clearInput(svg) {
    svg.parentNode.querySelector('.inputOutlined').value = ''
    svg.parentNode.previousElementSibling.classList.remove('inputLabelActive')
    svg.parentNode.nextElementSibling.textContent = 'Поле не может быть пустым!'
  }

  function fileClear(svg) {
    const inputFile = svg.parentNode.querySelector('.inputFile')
    inputFile.value = ''
    inputFile.style.color = '#ef5350'
    svg.remove()
  }

  function cancelContainer(container) {
    const form = document.querySelector(container)
    form.querySelector('.inputsContainer').scrollTo(0, 0)
    document.querySelector('.back').style.display = "none";
    document.querySelector(container).style.display = "none";
    form.reset()
    const allLabels = form.querySelectorAll('.inputLabelActive')
    Array.from(allLabels).map(item => item.classList.remove('inputLabelActive'))
    const allInputError = form.querySelectorAll('.inputError')
    Array.from(allInputError).map(item => item.textContent = '')
    form.querySelector('.inputsWarning').textContent = ''
    form.querySelector('.btnReport').style.display = 'none'
  }

  async function handleNewContainer(container) {
    const formInputs = document.querySelectorAll(`${container} input, ${container} textarea`)
    const data = Array.from(formInputs).map(item => item.value)
    const errors = document.querySelectorAll(`${container} .inputError`)
    const dataErr = Array.from(errors).map(item => item.innerText).filter(value => value)
    const checkEmptyValue = Array.from(formInputs).map(item => !item.value && item.required).filter(item => item)
    if (dataErr.length > 0 || checkEmptyValue.length > 0) {
      const inputsWarning = document.querySelector(`${container} .inputsWarning`)
      inputsWarning.textContent = 'Заполните необходимые поля и без ошибок!'
      return
    }
    document.querySelector('.back').style.zIndex = 88;
    const form = document.querySelector(`${container}`)
    form.querySelector('.inputsContainer').scrollTo(0, 0)
    if (container.includes('newArrivalZIPContainer')) {
      const files = await getFiles('nArZ9')
      form.reset()
      onSuccess({
        result: 'success',
        func: 'newArrivalZIP',
        data
      })
      //   google.script.run
      //     .withSuccessHandler(onSuccess)
      //     .writeNewPodmena(data, files)
      return
    }
    if (container.includes('newWriteOffZIPContainer')) {
      const files = await getFiles('nWoZ9')
      form.reset()
      onSuccess({
        result: 'success',
        func: 'newWriteOffZIP',
        data
      })
      //   google.script.run
      //     .withSuccessHandler(onSuccess)
      //     .writeNewPodmena(data, files)
      return
    }
    if (container.includes('newWriteOffPodmenaContainer')) {
      const files = await getFiles('nWoP8')
      form.reset()
      onSuccess({
        result: 'success',
        func: 'newWriteOffPodmena',
        data
      })
      //   google.script.run
      //     .withSuccessHandler(onSuccess)
      //     .writeNewPodmena(data, files)
      return
    }

    if (container.includes('newArrivalPodmenaContainer')) {
      const files = await getFiles('nArP7')
      form.reset()
      onSuccess({
        result: 'success',
        func: 'newArrivalPodmena',
        data
      })
      //   google.script.run
      //     .withSuccessHandler(onSuccess)
      //     .writeNewPodmena(data, files)
      return
    }
    if (container.includes('newMovingZIPContainer')) {
      const label = form.querySelector('label[for="nMvZ3"]')
      label.innerText = `Укажите количество*`
      Array.from(formInputs).map(item => {
        if (item.classList.contains('disabled')){
          item.disabled = false
          item.classList.remove('disabled')
        }
        if (item.classList.contains('textareaOutlined')){
          item.required = false
          item.name = 'nMvZ4.textNoValidRequired'
        }
      })
      form.reset()
      onSuccess({
        result: 'success',
        func: 'newMovingZIP',
        data
      })
      //   google.script.run
      //     .withSuccessHandler(onSuccess)
      //     .writeNewPodmena(data, files)
      return
    }
    if (container.includes('newMovingPodmenaContainer')) {
      form.reset()
      onSuccess({
        result: 'success',
        func: 'newMovingPodmena',
        data
      })
      //   google.script.run
      //     .withSuccessHandler(onSuccess)
      //     .writeNewPodmena(data, files)
      return
    }
    if (container.includes('PrintZIPContainer')) {
      form.reset()
      onSuccess({
        result: 'success',
        func: 'PrintZIP',
        data
      })
      return
    }
    if (container.includes('PrintPodmenaContainer')) {
      form.reset()
      onSuccess({
        result: 'success',
        func: 'PrintPodmena',
        data
      })
      return
    }
    if (container.includes('PrintAllContainer')) {
      form.reset()
      onSuccess({
        result: 'success',
        func: 'PrintAll',
        data
      })
      return
    }

  }

  async function getFiles(idInput) {
    const f = document.getElementById(idInput)
    return await Promise.all([...f.files].map((file, i) => {
      const fr = new FileReader();
      return (new Promise((r) => {
        fr.onload = (e) => {
          const data = e.target.result.split(",");
          return (r({
            fileName: f.files[i].name,
            mimeType: data[0].match(/:(\w.+);/)[1],
            data: data[1]
          }))
        }
        fr.readAsDataURL(file);
      }))
    }))
  }

  const dropFileZone = document.querySelectorAll(".inputFileLabel")
  Array.from(dropFileZone).map((item, index) => {
    item.addEventListener("dragover", function (event) {
      event.preventDefault()
      item.classList.add("drag_active")
    })

    item.addEventListener("dragleave", function (event) {
      if (!item.contains(event.relatedTarget)) {
        event.preventDefault()
        item.classList.remove("drag_active")
      }
    })

    item.addEventListener("drop", function (event) {
      event.preventDefault()
      item.classList.remove("drag_active")
      const file = event.dataTransfer.files
      if (!file) {
        return
      }
      const uploadInput = document.querySelector(".inputFile")
      const inputError = uploadInput.parentNode.nextElementSibling
      if (file.length <= 10 && inputError.textContent) {
        inputError.textContent = ""
      }
      if (file.length > 10) {
        inputError.textContent = 'Не более 10 файлов!'
        uploadInput.value = ''
        return
      }
      uploadInput.files = event.dataTransfer.files
      const svg = uploadInput.querySelector('.svgFileClear')
      if (uploadInput.value && !svg) {
        uploadInput.style.color = '#C1EEE1'
        uploadInput.parentNode.parentNode.insertAdjacentHTML('beforeend', svgFileClear)
      }
    })
  })

  function textValidation(value) {
    if (value === '') return {
      status: true,
      error: 'Поле не может быть пустым!'
    }
    if (!value.match('^[?!-, .а-яА-ЯёЁ0-9s]+$')) {
      return {
        status: true,
        error: 'Только кирилица, цифры, точка, пробел, тире!'
      }
    }
    if (!value.match('^[А-ЯA-Z]')) {
      return {
        status: true,
        error: 'Должно начинаться с заглавной буквы!'
      }
    }
    return {
      status: false
    }
  }

  function textRuEngValidation(value) {
    if (value === '') return {
      status: true,
      error: 'Поле не может быть пустым!'
    }
    if (!value.match('^[-_?+!, .а-яА-ЯёЁ0-9a-zA-Zs]+$')) {
      return {
        status: true,
        error: 'Только кирилица и английский, цифры, точка, пробел, тире!'
      }
    }
    if (!value.match('^[А-ЯA-Z]')) {
      return {
        status: true,
        error: 'Должно начинаться с заглавной буквы!'
      }
    }
    return {
      status: false
    }
  }

  function textLightValidation(value) {
    if (value === '') return {
      status: true,
      error: 'Поле не может быть пустым!'
    }
    return {
      status: false
    }
  }

  function textNoValidRequired(value) {
    return {
      status: false
    }
  }

  function emailValidation(value) {
    if (value === '') return {
      status: true,
      error: 'Поле не может быть пустым!'
    }
    if (!value.match('^[a-zA-z0-9]+[a-zA-Z\\d-_.]*@[a-z\\d-_]+\\.')) {
      return {
        status: true,
        error: 'Неправильный email'
      }
    }
    return {
      status: false
    }
  }

  function numberValidation(value) {
    if (value === '') return {
      status: true,
      error: 'Поле не может быть пустым!'
    }
    if (!value.match('^[0-9]+$')) {
      return {
        status: true,
        error: 'Только числа'
      }
    }
    return {
      status: false
    }
  }

  function coordinatesValidation(value) {
    if (value === '') return {
      status: true,
      error: 'Поле не может быть пустым!'
    }
    if (!value.match(
        '^([-+]?)([0-9]{1,2})([,.])([0-9]{1,6})([,])([ ])([-+]?)([0-9]{1,2})([,.])([0-9]{1,6})'
      )) {
      return {
        status: true,
        error: 'Не соответсвует формату координат'
      }
    }
    return {
      status: false
    }
  }

  function preparePrintData(data, dataList){
    const today = getTodayDDMMYYY()
    const printform = document.createElement('div');
    printform.classList.add('printContainer');
    printform.insertAdjacentHTML('afterbegin', `
  <div style="padding: 15px">
    <h2 style="position: absolute;">ООО "Сервисное Бюро Инноваций"</h2>
    <div style="display: flex; justify-content: flex-end; align-items: flex-end;">
      <h3 style="margin: 0; margin-right: 10px;" class="actTitle">АКТ</h3>
      <table>
        <thead>
          <tr>
            <th>Номер документа</th>
            <th>Дата составления</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>${list.actNumber}</td>
            <td>${today}</td>
          </tr>
        </tbody>
      </table>
    </div>
    <h2 style="margin-top: 40px; text-align: center;">О ПРИЕМЕ-ПЕРЕДАЧИ ТОВАРНО-МАТЕРИАЛЬНЫХ ЦЕННОСТЕЙ НА ХРАНЕНИЕ</h2>
    <span>Акт составлен в том, что приняты на хренение следующие товарно-материальные ценности:</span>
    <table style="font-size: 13px; width: 100%; margin-top: 15px">
      <thead>
        <tr>
          <th style="width:57px">Номер по порядку</th>
          <th>Наименование</th>
          <th style="width:150px">Классификатор</th>
          <th style="width:150px">Номер</th>
          <th style="width:70px">Единица измерения</th>
          <th style="width:80px">Количество</th>
        </tr>
      </thead>
      <tbody>
        <tr style="font-size: 10px;">
          <td>1</td>
          <td>2</td>
          <td>3</td>
          <td>4</td>
          <td>5</td>
          <td>6</td>
        </tr>
        ${dataList}
      </tbody>
    </table>
    <div style="margin-top: 15px">Особые отметки</div>
    <hr style="margin-top: 20px; width: 100%" size=1>
    <div style="margin-top: 15px">Товарно-материальные ценности на хранение</div>
    <table style="font-size: 13px; width: 100%; margin-top: 10px">
      <tr style="vertical-align: bottom;">
        <td style="border: 0; text-align: right; font-weight: bold; width: 50px">сдал</td>
        <td style="border: 0"></td>
        <td style="border: 0; width: 30px"></td>
        <td style="border: 0"></td>
        <td style="border: 0; width: 30px"></td>
        <td style="border: 0">${data}</td>
      </tr>
      <tr>
        <td style="border: 0"></td>
        <td style="border-top: 1px solid #000; border-left: 0; border-bottom: 0; border-right: 0">должность</td>
        <td style="border: 0"></td>
        <td style="border-top: 1px solid #000; border-left: 0; border-bottom: 0; border-right: 0">подпись</td>
        <td style="border: 0"></td>
        <td style="border-top: 1px solid #000; border-left: 0; border-bottom: 0; border-right: 0">расшифрока подписи</td>
      </tr>
      <tr style="height: 40px;vertical-align: bottom;">
        <td style="border: 0; text-align: right; font-weight: bold;">принял</td>
        <td style="border: 0"></td>
        <td style="border: 0; width: 30px"></td>
        <td style="border: 0"></td>
        <td style="border: 0; width: 30px"></td>
        <td style="border: 0">${list.user}</td>
      </tr>
      <tr>
        <td style="border: 0"></td>
        <td style="border-top: 1px solid #000; border-left: 0; border-bottom: 0; border-right: 0">должность</td>
        <td style="border: 0"></td>
        <td style="border-top: 1px solid #000; border-left: 0; border-bottom: 0; border-right: 0">подпись</td>
        <td style="border: 0"></td>
        <td style="border-top: 1px solid #000; border-left: 0; border-bottom: 0; border-right: 0">расшифрока подписи</td>
      </tr>
    </table>
  </div>`
  )
    const printElement = document.getElementById('printContent')
    printElement.appendChild(printform)
    window.print();
    printform.remove()
    list.actNumber++
  }

  function createData(item, label){
    const data = list.reportData.reduce((cnt, cur) => (cnt[cur] = cnt[cur] + 1 || 1, cnt), {});
    let table = ''
    for (var key of Object.keys(data)) {
      table += `<tr><td>${key}</td><td>${data[key]}</td></tr>`
    }
    list.reportHTML = `
      <table>
        <thead>
          <tr>
            <th>${item}</th>
            <th>Количество</th>
          </tr>
        </thead>
        <tbody>
          ${table}
      </table>
    ` 
    const dataForm = document.createElement('div');
    dataForm.classList.add('dataForm');
    dataForm.insertAdjacentHTML('afterbegin', list.reportHTML)
    if (label === 'ЗИП'){
      const dataElement = document.getElementById('dataZIP')
      dataElement.appendChild(dataForm)
      document.querySelector('.btnZIPReport').style.display = 'block'
    }
    if (label === 'Подмена'){
      const dataElement = document.getElementById('dataPodmena')
      dataElement.appendChild(dataForm)
      document.querySelector('.btnPodmenaReport').style.display = 'block'
    }
    if (label === 'Склад'){
      const dataElement = document.getElementById('dataWarehouse')
      dataElement.appendChild(dataForm)
      document.querySelector('.btnWarehouseReport').style.display = 'block'
    }
  }

  function printReport(element){
    document.querySelector('.back').style.zIndex = 13;
    document.querySelector('.back').style.display = "none";

    const printform = document.createElement('div');
    printform.classList.add('printContainer');
    printform.classList.add('printStyleReport');
    printform.insertAdjacentHTML('afterbegin', list.reportHTML)

    const printElement = document.getElementById('printContent')
    printElement.appendChild(printform)
    window.print();
    document.querySelector('.back').style.display = "block";
    printElement.replaceChildren()
  }

  function getTodayDDMMYYY(){
    const today = new Date();
    const dd = today.getDate() < 10 ? `0${today.getDate()}` : today.getDate()
    const mm = today.getMonth()+1 < 10 ? `0${today.getMonth()+1}` : today.getMonth()+1
    const yyyy = today.getFullYear();
    return `${dd}.${mm}.${yyyy}` 
  }
  const svgErr =
    "<svg class='modalSVGErr' version='1.1' id='Capa_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 455.111 455.111' style='enable-background:new 0 0 455.111 455.111;' xml:space='preserve'><circle style='fill:#E24C4B;' cx='227.556' cy='227.556' r='227.556'/><path style='fill:#D1403F;' d='M455.111,227.556c0,125.156-102.4,227.556-227.556,227.556c-72.533,0-136.533-32.711-177.778-85.333c38.4,31.289,88.178,49.778,142.222,49.778c125.156,0,227.556-102.4,227.556-227.556c0-54.044-18.489-103.822-49.778-142.222C422.4,91.022,455.111,155.022,455.111,227.556z'/><path style='fill:#FFFFFF;' d='M331.378,331.378c-8.533,8.533-22.756,8.533-31.289,0l-72.533-72.533l-72.533,72.533c-8.533,8.533-22.756,8.533-31.289,0c-8.533-8.533-8.533-22.756,0-31.289l72.533-72.533l-72.533-72.533c-8.533-8.533-8.533-22.756,0-31.289c8.533-8.533,22.756-8.533,31.289,0l72.533,72.533l72.533-72.533c8.533-8.533,22.756-8.533,31.289,0c8.533,8.533,8.533,22.756,0,31.289l-72.533,72.533l72.533,72.533C339.911,308.622,339.911,322.844,331.378,331.378z'/><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g></svg>";
  const svgOk =
    "<svg class='modalSVGOK' version='1.0' xmlns='http://www.w3.org/2000/svg'  width='1222.000000pt' height='1280.000000pt' viewBox='0 0 1222.000000 1280.000000' preserveAspectRatio='xMidYMid meet'><metadata>Created by potrace 1.15, written by Peter Selinger 2001-2017</metadata><g transform='translate(0.000000,1280.000000) scale(0.100000,-0.100000)'fill='#4caf50' stroke='none'><path d='M7271 12780 c-79 -21 -133 -55 -155 -98 -8 -16 -18 -93 -25 -187 -80 -1109 -253 -1873 -531 -2343 -141 -238 -279 -387 -585 -630 -340 -271 -528 -471 -629 -670 -15 -30 -72 -165 -128 -300 -300 -738 -565 -1282 -836 -1719 -265 -425 -548 -739 -783 -867 -116 -63 -180 -76 -365 -76 l-164 0 0 -2625 c0 -1444 2 -2625 5 -2625 3 0 62 -11 132 -24 71 -14 251 -48 400 -75 150 -28 393 -73 540 -101 1744 -324 1588 -298 1917 -325 485 -39 1028 -73 1566 -97 369 -16 1398 -16 1650 0 515 34 826 90 1010 182 324 163 742 555 873 818 l42 85 6 336 c4 246 9 345 19 371 29 76 94 154 305 366 236 236 306 319 360 429 80 163 68 256 -85 635 -101 252 -140 380 -140 464 0 103 64 208 270 441 229 260 292 369 276 481 -10 75 -62 184 -179 376 -202 333 -256 458 -243 557 10 73 56 154 182 321 223 295 252 353 240 486 -19 213 -189 556 -409 829 -83 103 -245 260 -322 311 -169 114 -421 159 -1110 195 -242 13 -1334 18 -2050 9 l-410 -5 -24 70 c-48 138 -29 362 53 622 81 256 179 480 450 1021 107 215 214 434 236 488 85 205 148 438 187 698 22 140 25 637 5 761 -73 454 -193 740 -413 978 -296 321 -816 521 -1138 437z'/> <path d='M386 6129 c-123 -29 -263 -139 -324 -255 -66 -127 -62 65 -62 -2674 0 -2181 2 -2493 15 -2549 43 -182 187 -329 370 -377 64 -17 1712 -20 1785 -3 181 42 346 215 380 398 14 74 14 4988 0 5062 -34 183 -199 356 -380 398 -57 13 -1728 13 -1784 0z'/> </g> </svg>";
  const svgCrossDropdown =
    '<svg class="svgDropdownCross" width="800px" height="800px" viewBox="0 0 24 24" fill="#C1EEE1" onclick="clearInput(this)"><path d="M6.99486 7.00636C6.60433 7.39689 6.60433 8.03005 6.99486 8.42058L10.58 12.0057L6.99486 15.5909C6.60433 15.9814 6.60433 16.6146 6.99486 17.0051C7.38538 17.3956 8.01855 17.3956 8.40907 17.0051L11.9942 13.4199L15.5794 17.0051C15.9699 17.3956 16.6031 17.3956 16.9936 17.0051C17.3841 16.6146 17.3841 15.9814 16.9936 15.5909L13.4084 12.0057L16.9936 8.42059C17.3841 8.03007 17.3841 7.3969 16.9936 7.00638C16.603 6.61585 15.9699 6.61585 15.5794 7.00638L11.9942 10.5915L8.40907 7.00636C8.01855 6.61584 7.38538 6.61584 6.99486 7.00636Z"></path></svg>'
  const svgFileClear =
    '<svg class="svgFileClear" width="800px" height="800px" viewBox="0 0 24 24" fill="#C1EEE1" onclick="fileClear(this)"><path d="M6.99486 7.00636C6.60433 7.39689 6.60433 8.03005 6.99486 8.42058L10.58 12.0057L6.99486 15.5909C6.60433 15.9814 6.60433 16.6146 6.99486 17.0051C7.38538 17.3956 8.01855 17.3956 8.40907 17.0051L11.9942 13.4199L15.5794 17.0051C15.9699 17.3956 16.6031 17.3956 16.9936 17.0051C17.3841 16.6146 17.3841 15.9814 16.9936 15.5909L13.4084 12.0057L16.9936 8.42059C17.3841 8.03007 17.3841 7.3969 16.9936 7.00638C16.603 6.61585 15.9699 6.61585 15.5794 7.00638L11.9942 10.5915L8.40907 7.00636C8.01855 6.61584 7.38538 6.61584 6.99486 7.00636Z"></path></svg>'
</script>

</html>
